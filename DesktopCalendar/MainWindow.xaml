<Window x:Class="DesktopCalendar.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="DeskFlow - ä»»åŠ¡ç®¡ç†"
        Width="1000" Height="700"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        WindowStartupLocation="CenterScreen"
        MouseLeftButtonDown="Window_MouseLeftButtonDown">

    <Window.Resources>
        <!-- å¯¼èˆªæŒ‰é’®æ ·å¼ -->
        <Style x:Key="NavButton" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="#90FFFFFF"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
            <Setter Property="Padding" Value="14,11"/>
            <Setter Property="Margin" Value="0,2"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Bd" Background="{TemplateBinding Background}" CornerRadius="8" Padding="{TemplateBinding Padding}">
                            <ContentPresenter/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#15FFFFFF"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- é€‰ä¸­çš„å¯¼èˆªæŒ‰é’®æ ·å¼ -->
        <Style x:Key="NavButtonActive" TargetType="Button" BasedOn="{StaticResource NavButton}">
            <Setter Property="Background" Value="#20FFFFFF"/>
            <Setter Property="Foreground" Value="White"/>
        </Style>
        
        <!-- æ—¶é—´é€‰é¡¹æŒ‰é’®æ ·å¼ -->
        <Style x:Key="TimeOptionButton" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Padding" Value="16,10"/>
            <Setter Property="Margin" Value="2"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Bd" Background="{TemplateBinding Background}" CornerRadius="6" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#30FFFFFF"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Border x:Name="MainBorder" CornerRadius="16" BorderThickness="1">
        <Border.Background>
            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                <GradientStop x:Name="GradientStart" Color="#FF0D0D12" Offset="0"/>
                <GradientStop x:Name="GradientEnd" Color="#FF1A1A24" Offset="1"/>
            </LinearGradientBrush>
        </Border.Background>
        <Border.BorderBrush>
            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                <GradientStop Color="#30FFFFFF" Offset="0"/>
                <GradientStop Color="#10FFFFFF" Offset="1"/>
            </LinearGradientBrush>
        </Border.BorderBrush>
        
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="240"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- ========== å·¦ä¾§è¾¹æ  ========== -->
            <Border Grid.Column="0" Background="#08FFFFFF" CornerRadius="16,0,0,16">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- é¡¶éƒ¨æ ‡é¢˜ -->
                    <Grid Grid.Row="0" Margin="18,18,18,24">
                        <StackPanel Orientation="Horizontal">
                            <Border Width="36" Height="36" CornerRadius="8">
                                <Border.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                        <GradientStop Color="#8B5CF6" Offset="0"/>
                                        <GradientStop Color="#3B82F6" Offset="1"/>
                                    </LinearGradientBrush>
                                </Border.Background>
                                <TextBlock Text="D" FontSize="20" FontWeight="Bold" FontFamily="Segoe UI" 
                                           Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <StackPanel Margin="12,0,0,0" VerticalAlignment="Center">
                                <TextBlock Text="DeskFlow" Foreground="White" FontSize="16" FontWeight="Bold" FontFamily="Segoe UI"/>
                                <TextBlock Text="æ•ˆçŽ‡å·¥ä½œå°" Foreground="#50FFFFFF" FontSize="10"/>
                            </StackPanel>
                        </StackPanel>
                    </Grid>

                    <!-- å¯¼èˆªèœå• -->
                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Hidden" Margin="10,0">
                        <StackPanel>
                            <!-- å¿«æ·å…¥å£ -->
                            <Grid Margin="0,0,0,16">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <!-- ä»Šæ—¥å¡ç‰‡ -->
                                <Border Grid.Column="0" CornerRadius="12" Margin="0,0,4,0" Cursor="Hand"
                                        MouseLeftButtonDown="QuickNav_Today">
                                    <Border.Background>
                                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                            <GradientStop Color="#3B82F6" Offset="0"/>
                                            <GradientStop Color="#2563EB" Offset="1"/>
                                        </LinearGradientBrush>
                                    </Border.Background>
                                    <StackPanel Margin="14,16">
                                        <TextBlock Text="ðŸ“Œ" FontSize="20"/>
                                        <TextBlock x:Name="TodayCardCount" Text="0" Foreground="White" FontSize="28" FontWeight="Bold" Margin="0,6,0,2"/>
                                        <TextBlock Text="ä»Šæ—¥å¾…åŠž" Foreground="#C0FFFFFF" FontSize="11"/>
                                    </StackPanel>
                                </Border>
                                
                                <!-- ç´§æ€¥å¡ç‰‡ -->
                                <Border Grid.Column="1" CornerRadius="12" Margin="4,0,0,0" Cursor="Hand"
                                        MouseLeftButtonDown="QuickNav_Urgent">
                                    <Border.Background>
                                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                            <GradientStop Color="#EF4444" Offset="0"/>
                                            <GradientStop Color="#DC2626" Offset="1"/>
                                        </LinearGradientBrush>
                                    </Border.Background>
                                    <StackPanel Margin="14,16">
                                        <TextBlock Text="âš¡" FontSize="20"/>
                                        <TextBlock x:Name="UrgentCardCount" Text="0" Foreground="White" FontSize="28" FontWeight="Bold" Margin="0,6,0,2"/>
                                        <TextBlock Text="ç´§æ€¥ä»»åŠ¡" Foreground="#C0FFFFFF" FontSize="11"/>
                                    </StackPanel>
                                </Border>
                            </Grid>
                            
                            <!-- è§†å›¾åˆ—è¡¨ -->
                            <TextBlock Text="è§†å›¾" Foreground="#45FFFFFF" FontSize="10" FontWeight="Medium" Margin="8,0,0,8"/>
                            
                            <Button x:Name="NavToday" Tag="Today" Click="NavFilter_Click" Style="{StaticResource NavButtonActive}">
                                <Grid>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="â—‰" Foreground="#3B82F6" FontSize="8" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                        <TextBlock Text="ä»Šå¤©" VerticalAlignment="Center"/>
                                    </StackPanel>
                                    <TextBlock x:Name="NavTodayCount" Text="" Foreground="#50FFFFFF" FontSize="11" 
                                               HorizontalAlignment="Right" VerticalAlignment="Center"/>
                                </Grid>
                            </Button>
                            
                            <Button x:Name="NavWeek" Tag="Week" Click="NavFilter_Click" Style="{StaticResource NavButton}">
                                <Grid>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="â—‰" Foreground="#8B5CF6" FontSize="8" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                        <TextBlock Text="æœ€è¿‘7å¤©" VerticalAlignment="Center"/>
                                    </StackPanel>
                                    <TextBlock x:Name="NavWeekCount" Text="" Foreground="#50FFFFFF" FontSize="11" 
                                               HorizontalAlignment="Right" VerticalAlignment="Center"/>
                                </Grid>
                            </Button>
                            
                            <Button x:Name="NavOverdue" Tag="Overdue" Click="NavFilter_Click" Style="{StaticResource NavButton}">
                                <Grid>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="â—‰" Foreground="#F97316" FontSize="8" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                        <TextBlock Text="å·²é€¾æœŸ/é¡ºå»¶" VerticalAlignment="Center"/>
                                    </StackPanel>
                                    <TextBlock x:Name="NavOverdueCount" Text="" Foreground="#F97316" FontSize="11" 
                                               HorizontalAlignment="Right" VerticalAlignment="Center"/>
                                </Grid>
                            </Button>
                            
                            <Button x:Name="NavCompleted" Tag="Completed" Click="NavFilter_Click" Style="{StaticResource NavButton}">
                                <Grid>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="âœ“" Foreground="#22C55E" FontSize="10" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                        <TextBlock Text="å·²å®Œæˆ" VerticalAlignment="Center"/>
                                    </StackPanel>
                                    <TextBlock x:Name="NavCompletedCount" Text="" Foreground="#50FFFFFF" FontSize="11" 
                                               HorizontalAlignment="Right" VerticalAlignment="Center"/>
                                </Grid>
                            </Button>
                            
                            <Button x:Name="NavAll" Tag="All" Click="NavFilter_Click" Style="{StaticResource NavButton}">
                                <Grid>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="â—‰" Foreground="#60FFFFFF" FontSize="8" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                        <TextBlock Text="å…¨éƒ¨å¾…åŠž" VerticalAlignment="Center"/>
                                    </StackPanel>
                                    <TextBlock x:Name="NavAllCount" Text="" Foreground="#50FFFFFF" FontSize="11" 
                                               HorizontalAlignment="Right" VerticalAlignment="Center"/>
                                </Grid>
                            </Button>

                            <Separator Background="#10FFFFFF" Margin="4,16"/>
                            
                            <!-- åˆ†ç±»ç®¡ç†ï¼ˆç¬¬ä¸€ä¸ªï¼‰ -->
                            <Grid Margin="8,0,0,8">
                                <TextBlock Text="åˆ†ç±»" Foreground="#45FFFFFF" FontSize="10" FontWeight="Medium"/>
                                <Button Content="ï¼‹" HorizontalAlignment="Right" FontSize="12" Foreground="#8B5CF6"
                                        Background="Transparent" BorderThickness="0" Cursor="Hand" Padding="4,0"
                                        Click="AddProject_Click" ToolTip="æ–°å»ºåˆ†ç±»"/>
                            </Grid>
                            
                            <!-- åˆ†ç±»åˆ—è¡¨ -->
                            <ItemsControl x:Name="ProjectNavList">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Button Tag="{Binding Id}" Click="ProjectNav_Click" Style="{StaticResource NavButton}" Margin="0,0,0,2">
                                            <Grid>
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock Text="{Binding Icon}" FontSize="14" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                                    <TextBlock Text="{Binding Name}" VerticalAlignment="Center"/>
                                                </StackPanel>
                                                <TextBlock Text="{Binding TaskCount}" Foreground="#8B5CF6" FontSize="11" 
                                                           HorizontalAlignment="Right" VerticalAlignment="Center"/>
                                            </Grid>
                                        </Button>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                            
                            <Separator Background="#10FFFFFF" Margin="4,16"/>
                            
                            <!-- å¤ç›˜å…¥å£ -->
                            <TextBlock Text="å¤ç›˜" Foreground="#45FFFFFF" FontSize="10" FontWeight="Medium" Margin="8,0,0,8"/>
                            
                            <Button x:Name="NavReview" Tag="Review" Click="NavReview_Click" Style="{StaticResource NavButton}">
                                <Grid>
                                    <StackPanel Orientation="Horizontal">
                                        <Border Width="18" Height="18" CornerRadius="5" Margin="0,0,10,0">
                                            <Border.Background>
                                                <LinearGradientBrush EndPoint="1,1">
                                                    <GradientStop Color="#6366F1" Offset="0"/>
                                                    <GradientStop Color="#8B5CF6" Offset="1"/>
                                                </LinearGradientBrush>
                                            </Border.Background>
                                            <TextBlock Text="ðŸ“Š" FontSize="10" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                        <TextBlock Text="æ•°æ®å¤ç›˜" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </Grid>
                            </Button>
                            
                            <!-- æ—¥è®°å…¥å£ -->
                            <Button x:Name="NavDiary" Tag="Diary" Click="NavDiary_Click" Style="{StaticResource NavButton}">
                                <Grid>
                                    <StackPanel Orientation="Horizontal">
                                        <Border Width="18" Height="18" CornerRadius="5" Margin="0,0,10,0">
                                            <Border.Background>
                                                <LinearGradientBrush EndPoint="1,1">
                                                    <GradientStop Color="#F59E0B" Offset="0"/>
                                                    <GradientStop Color="#EAB308" Offset="1"/>
                                                </LinearGradientBrush>
                                            </Border.Background>
                                            <TextBlock Text="ðŸ“" FontSize="10" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                        <TextBlock Text="æˆ‘çš„æ—¥è®°" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </Grid>
                            </Button>

                            <Separator Background="#10FFFFFF" Margin="4,16"/>
                            
                            <!-- ä¸»é¢˜åˆ‡æ¢ -->
                            <TextBlock Text="ä¸»é¢˜" Foreground="#45FFFFFF" FontSize="10" FontWeight="Medium" Margin="8,0,0,8"/>
                            <StackPanel Orientation="Horizontal" Margin="8,0,0,0">
                                <Border Width="28" Height="28" CornerRadius="14" Margin="0,0,8,0" Cursor="Hand"
                                        BorderBrush="#40FFFFFF" BorderThickness="2" MouseLeftButtonDown="Theme_Dark">
                                    <Border.Background>
                                        <LinearGradientBrush EndPoint="1,1">
                                            <GradientStop Color="#0D0D12" Offset="0"/>
                                            <GradientStop Color="#1A1A24" Offset="1"/>
                                        </LinearGradientBrush>
                                    </Border.Background>
                                </Border>
                                <Border Width="28" Height="28" CornerRadius="14" Margin="0,0,8,0" Cursor="Hand"
                                        BorderBrush="Transparent" BorderThickness="2" MouseLeftButtonDown="Theme_Blue">
                                    <Border.Background>
                                        <LinearGradientBrush EndPoint="1,1">
                                            <GradientStop Color="#1E3A5F" Offset="0"/>
                                            <GradientStop Color="#0F172A" Offset="1"/>
                                        </LinearGradientBrush>
                                    </Border.Background>
                                </Border>
                                <Border Width="28" Height="28" CornerRadius="14" Margin="0,0,8,0" Cursor="Hand"
                                        BorderBrush="Transparent" BorderThickness="2" MouseLeftButtonDown="Theme_Purple">
                                    <Border.Background>
                                        <LinearGradientBrush EndPoint="1,1">
                                            <GradientStop Color="#2E1E3F" Offset="0"/>
                                            <GradientStop Color="#1A0F2E" Offset="1"/>
                                        </LinearGradientBrush>
                                    </Border.Background>
                                </Border>
                                <Border Width="28" Height="28" CornerRadius="14" Cursor="Hand"
                                        BorderBrush="Transparent" BorderThickness="2" MouseLeftButtonDown="Theme_Green">
                                    <Border.Background>
                                        <LinearGradientBrush EndPoint="1,1">
                                            <GradientStop Color="#1E2E1E" Offset="0"/>
                                            <GradientStop Color="#0F1A0F" Offset="1"/>
                                        </LinearGradientBrush>
                                    </Border.Background>
                                </Border>
                            </StackPanel>
                            
                        </StackPanel>
                    </ScrollViewer>

                    <!-- åº•éƒ¨åŒºåŸŸï¼šè¿›åº¦ + æ”¯æŒä½œè€… -->
                    <StackPanel Grid.Row="2" Margin="10,0,10,10">
                        <!-- ä»Šæ—¥è¿›åº¦ -->
                        <Border CornerRadius="10" Padding="14,12" Margin="0,0,0,8">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Color="#15FFFFFF" Offset="0"/>
                                    <GradientStop Color="#08FFFFFF" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>
                            <StackPanel>
                                <Grid Margin="0,0,0,8">
                                    <TextBlock Text="ä»Šæ—¥è¿›åº¦" Foreground="#70FFFFFF" FontSize="11"/>
                                    <TextBlock x:Name="CompletionRate" Text="0%" Foreground="#22C55E" FontSize="11" FontWeight="Bold" HorizontalAlignment="Right"/>
                                </Grid>
                                <Border Background="#15FFFFFF" CornerRadius="4" Height="6">
                                    <Border x:Name="ProgressBar" Background="#22C55E" CornerRadius="4" HorizontalAlignment="Left" Width="0"/>
                                </Border>
                            </StackPanel>
                        </Border>
                        
                        <!-- äº‘åŒæ­¥çŠ¶æ€ -->
                        <Border x:Name="CloudSyncSection" CornerRadius="10" Padding="12,10" Margin="0,0,0,8" Cursor="Hand"
                                MouseLeftButtonDown="CloudSync_Click">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                    <GradientStop Color="#15FFFFFF" Offset="0"/>
                                    <GradientStop Color="#10FFFFFF" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>
                            <Border.Style>
                                <Style TargetType="Border">
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="#20FFFFFF"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </Border.Style>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock x:Name="CloudIcon" Text="â˜ï¸" FontSize="16" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                    <TextBlock x:Name="CloudStatusText" Text="ç‚¹å‡»ç™»å½•åŒæ­¥æ•°æ®" Foreground="#80FFFFFF" FontSize="11"/>
                                    <TextBlock x:Name="CloudUserEmail" Text="" Foreground="#50FFFFFF" FontSize="9" 
                                               Visibility="Collapsed" TextTrimming="CharacterEllipsis"/>
                                </StackPanel>
                                <TextBlock x:Name="SyncStatusIcon" Grid.Column="2" Text="â†’" Foreground="#50FFFFFF" 
                                           FontSize="12" VerticalAlignment="Center"/>
                            </Grid>
                        </Border>
                        
                        <!-- æ”¯æŒä½œè€… -->
                        <Border Background="#10FFFFFF" CornerRadius="10" Padding="12,10" Cursor="Hand"
                                MouseLeftButtonDown="SupportAuthor_Click">
                            <Border.Style>
                                <Style TargetType="Border">
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="#20FFFFFF"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </Border.Style>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                <TextBlock Text="â˜•" FontSize="13" VerticalAlignment="Center" Margin="0,0,6,0"/>
                                <TextBlock Text="æ”¯æŒä½œè€…" Foreground="#80FFFFFF" FontSize="11" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- ========== å³ä¾§ä¸»å†…å®¹åŒº ========== -->
            <Grid Grid.Column="1" Margin="24,20">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- æ ‡é¢˜ -->
                <StackPanel Grid.Row="0" Margin="0,0,0,20">
                    <TextBlock x:Name="ViewTitle" Text="ä»Šå¤©" Foreground="White" FontSize="28" FontWeight="Bold"/>
                    <TextBlock x:Name="ViewSubtitle" Text="" Foreground="#50FFFFFF" FontSize="13" Margin="0,6,0,0"/>
                </StackPanel>

                <!-- ä»Šæ—¥å›žé¡¾å¡ç‰‡ -->
                <Border x:Name="TodayReviewCard" Grid.Row="1" CornerRadius="16" Padding="20,16" Margin="0,0,0,16" Cursor="Hand"
                        MouseLeftButtonDown="TodayReviewCard_Click">
                    <Border.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                            <GradientStop Color="#6366F1" Offset="0"/>
                            <GradientStop Color="#8B5CF6" Offset="0.5"/>
                            <GradientStop Color="#A855F7" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <!-- å·¦ä¾§ä¿¡æ¯ -->
                        <StackPanel Grid.Column="0">
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                <TextBlock Text="ðŸŒŸ" FontSize="18" Margin="0,0,8,0"/>
                                <TextBlock Text="ä»Šæ—¥å›žé¡¾" FontSize="16" FontWeight="Bold" Foreground="White"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock x:Name="TodayCompletedText" Text="å®Œæˆ 0 é¡¹" Foreground="#E0FFFFFF" FontSize="13"/>
                                <TextBlock Text=" Â· " Foreground="#80FFFFFF" FontSize="13"/>
                                <TextBlock x:Name="TodayStreakText" Text="è¿žç»­ 0 å¤©é«˜æ•ˆ" Foreground="#E0FFFFFF" FontSize="13"/>
                            </StackPanel>
                        </StackPanel>
                        
                        <!-- å³ä¾§è¿›åº¦çŽ¯ -->
                        <Grid Grid.Column="1" Width="56" Height="56">
                            <Ellipse Stroke="#40FFFFFF" StrokeThickness="4" Fill="Transparent"/>
                            <Ellipse x:Name="TodayProgressRing" Stroke="White" StrokeThickness="4" Fill="Transparent"
                                     StrokeDashArray="100,100" StrokeDashOffset="25" RenderTransformOrigin="0.5,0.5">
                                <Ellipse.RenderTransform>
                                    <RotateTransform Angle="-90"/>
                                </Ellipse.RenderTransform>
                            </Ellipse>
                            <TextBlock x:Name="TodayProgressText" Text="0%" FontSize="12" FontWeight="Bold" 
                                       Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Grid>
                    </Grid>
                </Border>

                <!-- å¿«æ·æ·»åŠ  -->
                <Border x:Name="AddTodoSection" Grid.Row="2" CornerRadius="14" Padding="18,16" Margin="0,0,0,20"
                        BorderBrush="#15FFFFFF" BorderThickness="1">
                    <Border.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                            <GradientStop Color="#12FFFFFF" Offset="0"/>
                            <GradientStop Color="#08FFFFFF" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <!-- è¾“å…¥è¡Œ -->
                        <Grid Grid.Row="0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <TextBox x:Name="QuickAddBox" Background="Transparent" BorderThickness="0"
                                     Foreground="White" FontSize="15" CaretBrush="White" VerticalAlignment="Center"
                                     KeyDown="QuickAdd_KeyDown"/>
                            <TextBlock Text="ï¼‹ æ·»åŠ å¾…åŠžï¼ˆæ”¯æŒï¼šæ˜Žå¤©ã€ä¸‹å‘¨ä¸€ã€å‘¨äº”ï¼‰" 
                                       Foreground="#35FFFFFF" FontSize="15" VerticalAlignment="Center"
                                       IsHitTestVisible="False"
                                       Visibility="{Binding Text.Length, ElementName=QuickAddBox, Converter={StaticResource LengthToVisibilityConverter}}"/>
                            
                            <Button Grid.Column="1" Content="æ·»åŠ " Foreground="White"
                                    Padding="24,12" BorderThickness="0" Cursor="Hand" Click="QuickAdd_Click" FontWeight="Medium">
                                <Button.Background>
                                    <LinearGradientBrush EndPoint="1,0">
                                        <GradientStop Color="#6366F1" Offset="0"/>
                                        <GradientStop Color="#8B5CF6" Offset="1"/>
                                    </LinearGradientBrush>
                                </Button.Background>
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}" CornerRadius="10" Padding="{TemplateBinding Padding}">
                                            <ContentPresenter HorizontalAlignment="Center"/>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Opacity" Value="0.9"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                        </Grid>
                        
                        <!-- é€‰é¡¹è¡Œ -->
                        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,14,0,0">
                            <!-- ä¼˜å…ˆçº§ -->
                            <Border x:Name="PriorityHigh" Background="Transparent" BorderBrush="#EF4444" BorderThickness="1.5" 
                                    CornerRadius="6" Padding="12,6" Margin="0,0,8,0" Cursor="Hand" MouseLeftButtonDown="Priority_Select" Tag="High">
                                <StackPanel Orientation="Horizontal">
                                    <Ellipse Width="8" Height="8" Fill="#EF4444" Margin="0,0,6,0"/>
                                    <TextBlock Text="ç´§æ€¥" Foreground="#EF4444" FontSize="12"/>
                                </StackPanel>
                            </Border>
                            <Border x:Name="PriorityMedium" Background="Transparent" BorderBrush="#F59E0B" BorderThickness="1.5" 
                                    CornerRadius="6" Padding="12,6" Margin="0,0,8,0" Cursor="Hand" MouseLeftButtonDown="Priority_Select" Tag="Medium">
                                <StackPanel Orientation="Horizontal">
                                    <Ellipse Width="8" Height="8" Fill="#F59E0B" Margin="0,0,6,0"/>
                                    <TextBlock Text="é‡è¦" Foreground="#F59E0B" FontSize="12"/>
                                </StackPanel>
                            </Border>
                            <Border x:Name="PriorityLow" CornerRadius="6" Padding="12,6" Cursor="Hand" MouseLeftButtonDown="Priority_Select" Tag="Low">
                                <Border.Background>
                                    <LinearGradientBrush EndPoint="1,0">
                                        <GradientStop Color="#22C55E" Offset="0"/>
                                        <GradientStop Color="#16A34A" Offset="1"/>
                                    </LinearGradientBrush>
                                </Border.Background>
                                <StackPanel Orientation="Horizontal">
                                    <Ellipse Width="8" Height="8" Fill="White" Margin="0,0,6,0"/>
                                    <TextBlock Text="æ™®é€š" Foreground="White" FontSize="12"/>
                                </StackPanel>
                            </Border>
                            
                            <Border Background="#20FFFFFF" Width="1" Height="20" Margin="16,0"/>
                            
                            <!-- åˆ†ç»„ -->
                            <ComboBox x:Name="GroupCombo" FontSize="12" Width="100" SelectedIndex="0">
                                <ComboBox.Style>
                                    <Style TargetType="ComboBox">
                                        <Setter Property="Background" Value="#25FFFFFF"/>
                                        <Setter Property="Foreground" Value="White"/>
                                        <Setter Property="BorderThickness" Value="0"/>
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="ComboBox">
                                                    <Grid>
                                                        <Border x:Name="Bd" Background="#20FFFFFF" CornerRadius="6" Padding="10,6">
                                                            <Grid>
                                                                <ContentPresenter Content="{TemplateBinding SelectionBoxItem}" 
                                                                                  ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                                                                  VerticalAlignment="Center"/>
                                                                <TextBlock Text="â–¼" FontSize="8" Foreground="#70FFFFFF" 
                                                                           HorizontalAlignment="Right" VerticalAlignment="Center"/>
                                                            </Grid>
                                                        </Border>
                                                        <Popup x:Name="PART_Popup" IsOpen="{TemplateBinding IsDropDownOpen}" 
                                                               Placement="Bottom" AllowsTransparency="True">
                                                            <Border Background="#252530" CornerRadius="6" Margin="0,4,0,0"
                                                                    BorderBrush="#30FFFFFF" BorderThickness="1">
                                                                <ItemsPresenter/>
                                                            </Border>
                                                        </Popup>
                                                        <ToggleButton x:Name="ToggleButton" IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                                                      Background="Transparent" BorderThickness="0" Opacity="0"/>
                                                    </Grid>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </ComboBox.Style>
                                <ComboBox.ItemContainerStyle>
                                    <Style TargetType="ComboBoxItem">
                                        <Setter Property="Background" Value="Transparent"/>
                                        <Setter Property="Foreground" Value="White"/>
                                        <Setter Property="Padding" Value="10,8"/>
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="ComboBoxItem">
                                                    <Border x:Name="Bd" Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}">
                                                        <ContentPresenter/>
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter TargetName="Bd" Property="Background" Value="#3B82F6"/>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </ComboBox.ItemContainerStyle>
                                <ComboBoxItem Content="æœªåˆ†ç»„" Tag=""/>
                            </ComboBox>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- å¾…åŠžåˆ—è¡¨ -->
                <ListBox Grid.Row="3" x:Name="TodoList" Background="Transparent" BorderThickness="0"
                         ItemsSource="{Binding FilteredTodos}" ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                         MouseDoubleClick="TodoList_DoubleClick">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <Border CornerRadius="12" Padding="16,14" BorderBrush="#10FFFFFF" BorderThickness="1">
                                <Border.Margin>
                                    <MultiBinding Converter="{StaticResource SubTaskIndentConverter}">
                                        <Binding Path="IsSubTask"/>
                                    </MultiBinding>
                                </Border.Margin>
                                <!-- å­ä»»åŠ¡èƒŒæ™¯ç¨æ·± -->
                                <Border.Style>
                                    <Style TargetType="Border">
                                        <Setter Property="Background" Value="#08FFFFFF"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsSubTask}" Value="True">
                                                <Setter Property="Background" Value="#05FFFFFF"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Border.Style>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <!-- å±•å¼€/æ”¶èµ·æŒ‰é’®ï¼ˆä»…æœ‰å­ä»»åŠ¡çš„çˆ¶ä»»åŠ¡æ˜¾ç¤ºï¼‰ -->
                                    <Button Grid.Column="0" Width="20" Height="20" Margin="0,0,8,0" Cursor="Hand"
                                            Style="{StaticResource IconButton}" FontSize="9"
                                            Content="{Binding IsExpanded, Converter={StaticResource ExpandIconConverter}}"
                                            Click="ToggleExpand_Click" Tag="{Binding Id}"
                                            Visibility="{Binding HasSubTasks, Converter={StaticResource BoolToVisibilityConverter}}"
                                            Foreground="#60FFFFFF" ToolTip="å±•å¼€/æ”¶èµ·å­ä»»åŠ¡"/>

                                    <!-- å®ŒæˆæŒ‰é’® -->
                                    <Border Grid.Column="1" Width="24" Height="24" CornerRadius="12" 
                                            BorderBrush="{Binding Priority, Converter={StaticResource PriorityToColorConverter}}" 
                                            BorderThickness="2" Margin="0,0,14,0" Cursor="Hand"
                                            Background="{Binding IsCompleted, Converter={StaticResource CompletedToBackgroundConverter}}"
                                            MouseLeftButtonDown="ToggleComplete_Click" Tag="{Binding Id}">
                                        <TextBlock Text="âœ“" Foreground="White" FontSize="12" FontWeight="Bold"
                                                   HorizontalAlignment="Center" VerticalAlignment="Center"
                                                   Visibility="{Binding IsCompleted, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                    </Border>

                                    <!-- ä¼˜å…ˆçº§æ¡ -->
                                    <Border Grid.Column="2" Width="4" CornerRadius="2" Margin="0,0,14,0"
                                            Background="{Binding Priority, Converter={StaticResource PriorityToColorConverter}}"/>

                                    <!-- å†…å®¹ -->
                                    <StackPanel Grid.Column="3" VerticalAlignment="Center">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="{Binding Title}" FontSize="14"
                                                       Foreground="{Binding IsCompleted, Converter={StaticResource CompletedToForegroundConverter}}"
                                                       TextDecorations="{Binding IsCompleted, Converter={StaticResource CompletedToStrikethroughConverter}}"/>
                                            <!-- å­ä»»åŠ¡è¿›åº¦æ ‡ç­¾ -->
                                            <Border CornerRadius="10" Padding="8,2" Margin="10,0,0,0"
                                                    Visibility="{Binding HasSubTasks, Converter={StaticResource BoolToVisibilityConverter}}">
                                                <Border.Background>
                                                    <SolidColorBrush Color="#3B82F6" Opacity="0.2"/>
                                                </Border.Background>
                                                <TextBlock FontSize="11" FontWeight="SemiBold" Foreground="#3B82F6">
                                                    <Run Text="ðŸ“‹ "/><Run Text="{Binding SubTaskProgress, Mode=OneWay}"/>
                                                </TextBlock>
                                            </Border>
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,6,0,0">
                                            <!-- æ—¥æœŸ -->
                                            <Border Background="#15FFFFFF" CornerRadius="4" Padding="8,3" Margin="0,0,8,0"
                                                    Visibility="{Binding DueDate, Converter={StaticResource NullToVisibilityConverter}}">
                                                <TextBlock Text="{Binding DueDate, StringFormat='Mæœˆdæ—¥'}" 
                                                           Foreground="#70FFFFFF" FontSize="11"/>
                                            </Border>
                                            <!-- åˆ†ç»„ï¼ˆå­ä»»åŠ¡ä¸æ˜¾ç¤ºåˆ†ç»„ï¼‰ -->
                                            <Border Background="#10FFFFFF" CornerRadius="4" Padding="8,3">
                                                <Border.Style>
                                                    <Style TargetType="Border">
                                                        <Setter Property="Visibility" Value="Visible"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding IsSubTask}" Value="True">
                                                                <Setter Property="Visibility" Value="Collapsed"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Border.Style>
                                                <TextBlock Text="{Binding GroupId, Converter={StaticResource GroupToNameConverter}}" 
                                                           Foreground="#50FFFFFF" FontSize="11"/>
                                            </Border>
                                            <!-- é€¾æœŸæ ‡è®° -->
                                            <Border CornerRadius="4" Padding="8,3" Margin="8,0,0,0"
                                                    Visibility="{Binding IsOverdue, Converter={StaticResource BoolToVisibilityConverter}}">
                                                <Border.Background>
                                                    <SolidColorBrush Color="#EF4444" Opacity="0.2"/>
                                                </Border.Background>
                                                <TextBlock Text="å·²é€¾æœŸ" Foreground="#EF4444" FontSize="11"/>
                                            </Border>
                                            <!-- å·²é¡ºå»¶æ ‡è®° -->
                                            <Border CornerRadius="4" Padding="8,3" Margin="8,0,0,0"
                                                    Visibility="{Binding IsPostponed, Converter={StaticResource BoolToVisibilityConverter}}">
                                                <Border.Background>
                                                    <SolidColorBrush Color="#F59E0B" Opacity="0.2"/>
                                                </Border.Background>
                                                <TextBlock Text="å·²é¡ºå»¶" Foreground="#F59E0B" FontSize="11"/>
                                            </Border>
                                        </StackPanel>
                                    </StackPanel>

                                    <!-- æ“ä½œ -->
                                    <StackPanel Grid.Column="4" Orientation="Horizontal" VerticalAlignment="Center">
                                        <!-- æ·»åŠ å­ä»»åŠ¡æŒ‰é’®ï¼ˆä»…éžå­ä»»åŠ¡æ˜¾ç¤ºï¼‰ -->
                                        <Button Content="ï¼‹" FontSize="14" ToolTip="æ·»åŠ å­ä»»åŠ¡"
                                                Click="AddSubTask_Click" Tag="{Binding Id}" Foreground="#60FFFFFF">
                                            <Button.Style>
                                                <Style TargetType="Button" BasedOn="{StaticResource IconButton}">
                                                    <Setter Property="Visibility" Value="Visible"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding IsSubTask}" Value="True">
                                                            <Setter Property="Visibility" Value="Collapsed"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Button.Style>
                                        </Button>
                                        <!-- é¡ºå»¶æŒ‰é’®ï¼ˆä»…é€¾æœŸæœªå®Œæˆä»»åŠ¡æ˜¾ç¤ºï¼‰ -->
                                        <Button Content="â†’ä»Šå¤©" Style="{StaticResource IconButton}" FontSize="10" ToolTip="é¡ºå»¶åˆ°ä»Šå¤©"
                                                Click="PostponeTask_Click" Tag="{Binding Id}" Foreground="#F59E0B"
                                                Visibility="{Binding IsOverdue, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                        <Button Content="âœï¸" Style="{StaticResource IconButton}" FontSize="13" ToolTip="ç¼–è¾‘"
                                                Click="EditTodo_Click" Tag="{Binding Id}"/>
                                        <Button Content="ðŸ—‘ï¸" Style="{StaticResource IconButton}" FontSize="13" ToolTip="åˆ é™¤"
                                                Click="DeleteTodo_Click" Tag="{Binding Id}"/>
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                    <ListBox.ItemContainerStyle>
                        <Style TargetType="ListBoxItem">
                            <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                            <Setter Property="Padding" Value="0"/>
                            <Setter Property="Margin" Value="0"/>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="ListBoxItem">
                                        <ContentPresenter/>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </ListBox.ItemContainerStyle>
                </ListBox>
                
                <!-- ç©ºçŠ¶æ€ -->
                <StackPanel x:Name="EmptyState" Grid.Row="3" VerticalAlignment="Center" HorizontalAlignment="Center"
                            Visibility="Collapsed">
                    <Border Width="80" Height="80" CornerRadius="40" Background="#10FFFFFF" Margin="0,0,0,20">
                        <TextBlock Text="ðŸ“" FontSize="36" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </Border>
                    <TextBlock Text="æš‚æ— å¾…åŠžäº‹é¡¹" Foreground="#60FFFFFF" FontSize="16" HorizontalAlignment="Center"/>
                    <TextBlock Text="åœ¨ä¸Šæ–¹è¾“å…¥æ¡†æ·»åŠ ä½ çš„ç¬¬ä¸€ä¸ªå¾…åŠž" Foreground="#35FFFFFF" FontSize="12" HorizontalAlignment="Center" Margin="0,8,0,0"/>
                </StackPanel>
            </Grid>
            
            <!-- ========== æ•°æ®å¤ç›˜é¢æ¿ ========== -->
            <Border x:Name="ReviewPanel" Grid.Column="1" Visibility="Collapsed" Background="#FF0D0D12">
                <Grid Margin="48,0,48,32">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- é¡¶éƒ¨å¯¼èˆªåŒº - å‚è€ƒ Linear/Notion é£Žæ ¼ -->
                    <Border Grid.Row="0" Margin="0,0,0,28" Padding="0,28,0,20" 
                            BorderBrush="#15FFFFFF" BorderThickness="0,0,0,1">
                        <Grid>
                            <!-- æ ‡é¢˜åŒº -->
                            <StackPanel VerticalAlignment="Center">
                                <TextBlock x:Name="ReviewTitle" Text="æ•°æ®ç»Ÿè®¡" Foreground="White" 
                                           FontSize="22" FontWeight="SemiBold" FontFamily="Microsoft YaHei UI"/>
                                <TextBlock x:Name="ReviewSubtitle" Text="" Foreground="#45FFFFFF" FontSize="11" Margin="0,3,0,0"/>
                            </StackPanel>
                            
                            <!-- Tab åˆ‡æ¢ - ä¸‹åˆ’çº¿é£Žæ ¼ -->
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,0,50,0">
                                <Border x:Name="ReviewDayTab" Padding="16,8" Cursor="Hand" Background="Transparent"
                                        MouseLeftButtonDown="ReviewPeriod_Click" Tag="Day">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Background" Value="#08FFFFFF"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <StackPanel>
                                        <TextBlock x:Name="ReviewDay" Text="ä»Šæ—¥" Foreground="White" FontSize="13" FontWeight="Medium" HorizontalAlignment="Center"/>
                                        <Border x:Name="ReviewDayIndicator" Height="2" Background="#6366F1" CornerRadius="1" Margin="0,6,0,0"/>
                                    </StackPanel>
                                </Border>
                                <Border x:Name="ReviewWeekTab" Padding="16,8" Cursor="Hand" Background="Transparent"
                                        MouseLeftButtonDown="ReviewPeriod_Click" Tag="Week" Margin="8,0,0,0">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Background" Value="#08FFFFFF"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <StackPanel>
                                        <TextBlock x:Name="ReviewWeek" Text="æœ¬å‘¨" Foreground="#60FFFFFF" FontSize="13" HorizontalAlignment="Center"/>
                                        <Border x:Name="ReviewWeekIndicator" Height="2" Background="Transparent" CornerRadius="1" Margin="0,6,0,0"/>
                                    </StackPanel>
                                </Border>
                                <Border x:Name="ReviewMonthTab" Padding="16,8" Cursor="Hand" Background="Transparent"
                                        MouseLeftButtonDown="ReviewPeriod_Click" Tag="Month" Margin="8,0,0,0">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Background" Value="#08FFFFFF"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <StackPanel>
                                        <TextBlock x:Name="ReviewMonth" Text="æœ¬æœˆ" Foreground="#60FFFFFF" FontSize="13" HorizontalAlignment="Center"/>
                                        <Border x:Name="ReviewMonthIndicator" Height="2" Background="Transparent" CornerRadius="1" Margin="0,6,0,0"/>
                                    </StackPanel>
                                </Border>
                                <Border x:Name="ReviewYearTab" Padding="16,8" Cursor="Hand" Background="Transparent"
                                        MouseLeftButtonDown="ReviewPeriod_Click" Tag="Year" Margin="8,0,0,0">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Background" Value="#08FFFFFF"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <StackPanel>
                                        <TextBlock x:Name="ReviewYear" Text="å…¨å¹´" Foreground="#60FFFFFF" FontSize="13" HorizontalAlignment="Center"/>
                                        <Border x:Name="ReviewYearIndicator" Height="2" Background="Transparent" CornerRadius="1" Margin="0,6,0,0"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Grid>
                    </Border>
                    
                    <!-- ä¸»å†…å®¹åŒº -->
                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Hidden">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <!-- ç¬¬ä¸€è¡Œï¼šå››ä¸ªç»Ÿè®¡å¡ç‰‡ -->
                            <Grid Grid.Row="0" Margin="0,0,0,20">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <!-- å·²å®Œæˆ -->
                                <Border Grid.Column="0" CornerRadius="16" Margin="0,0,8,0" Padding="20" Background="#15FFFFFF">
                                    <StackPanel>
                                        <TextBlock Text="å·²å®Œæˆ" Foreground="#70FFFFFF" FontSize="12"/>
                                        <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                                            <TextBlock x:Name="ReviewCompletedCount" Text="0" Foreground="White" FontSize="36" FontWeight="Bold"/>
                                            <TextBlock Text="é¡¹" Foreground="#50FFFFFF" FontSize="14" VerticalAlignment="Bottom" Margin="4,0,0,6"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                                
                                <!-- å®ŒæˆçŽ‡ -->
                                <Border Grid.Column="1" CornerRadius="16" Margin="4,0" Padding="20" Background="#15FFFFFF">
                                    <StackPanel>
                                        <TextBlock Text="å®ŒæˆçŽ‡" Foreground="#70FFFFFF" FontSize="12"/>
                                        <TextBlock x:Name="ReviewCompletionRate" Text="0%" Foreground="#22C55E" FontSize="36" FontWeight="Bold" Margin="0,8,0,0"/>
                                    </StackPanel>
                                </Border>
                                
                                <!-- è¿žç»­å¤©æ•°ï¼ˆæ¸å˜æ©™è‰²èƒŒæ™¯ï¼‰ -->
                                <Border Grid.Column="2" CornerRadius="16" Margin="4,0" Padding="20">
                                    <Border.Background>
                                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                            <GradientStop Color="#F97316" Offset="0"/>
                                            <GradientStop Color="#EA580C" Offset="1"/>
                                        </LinearGradientBrush>
                                    </Border.Background>
                                    <Grid>
                                        <StackPanel>
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="ðŸ”¥ è¿žç»­" Foreground="#DDFFFFFF" FontSize="12"/>
                                                <TextBlock x:Name="ReviewBestStreak" Text="æœ€ä½³ 0" Foreground="#99FFFFFF" FontSize="11" Margin="10,0,0,0"/>
                                            </StackPanel>
                                            <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                                                <TextBlock x:Name="ReviewStreakCount" Text="0" Foreground="White" FontSize="36" FontWeight="Bold"/>
                                                <TextBlock Text="å¤©" Foreground="#DDFFFFFF" FontSize="14" VerticalAlignment="Bottom" Margin="4,0,0,6"/>
                                            </StackPanel>
                                        </StackPanel>
                                    </Grid>
                                </Border>
                                
                                <!-- è¾ƒä¸Šå‘¨/è¾ƒæ˜¨æ—¥ -->
                                <Border Grid.Column="3" CornerRadius="16" Margin="8,0,0,0" Padding="20" Background="#15FFFFFF">
                                    <StackPanel>
                                        <TextBlock x:Name="ReviewCompareLabel" Text="è¾ƒä¸Šå‘¨" Foreground="#70FFFFFF" FontSize="12"/>
                                        <TextBlock x:Name="ReviewCompareValue" Text="+0" Foreground="#22C55E" FontSize="36" FontWeight="Bold" Margin="0,8,0,0"/>
                                    </StackPanel>
                                </Border>
                            </Grid>
                            
                            <!-- ç¬¬äºŒè¡Œï¼šè¶‹åŠ¿å›¾ + é¼“åŠ±æ–‡å­— -->
                            <Border Grid.Row="1" CornerRadius="16" Padding="24" Margin="0,0,0,20" Background="#10FFFFFF">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <StackPanel Grid.Column="0">
                                        <TextBlock x:Name="ReviewTrendTitle" Text="æœ¬å‘¨è¶‹åŠ¿" Foreground="White" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,20"/>
                                        
                                        <!-- æŸ±çŠ¶å›¾ - ä½¿ç”¨ UniformGrid è‡ªåŠ¨å‡åŒ€åˆ†å¸ƒ -->
                                        <UniformGrid x:Name="TrendChartGrid" Rows="1" Height="140">
                                            <StackPanel x:Name="TrendColumn0" VerticalAlignment="Bottom" HorizontalAlignment="Center">
                                                <TextBlock x:Name="TrendCount0" Text="" Foreground="#70FFFFFF" FontSize="11" HorizontalAlignment="Center" Margin="0,0,0,4"/>
                                                <Border x:Name="TrendBar0" Width="48" CornerRadius="6,6,0,0" Height="4" Background="#3B82F6"/>
                                                <TextBlock x:Name="TrendLabel0" Text="ä¸€" Foreground="#50FFFFFF" FontSize="12" HorizontalAlignment="Center" Margin="0,8,0,0"/>
                                            </StackPanel>
                                            <StackPanel x:Name="TrendColumn1" VerticalAlignment="Bottom" HorizontalAlignment="Center">
                                                <TextBlock x:Name="TrendCount1" Text="" Foreground="#70FFFFFF" FontSize="11" HorizontalAlignment="Center" Margin="0,0,0,4"/>
                                                <Border x:Name="TrendBar1" Width="48" CornerRadius="6,6,0,0" Height="4" Background="#3B82F6"/>
                                                <TextBlock x:Name="TrendLabel1" Text="äºŒ" Foreground="#50FFFFFF" FontSize="12" HorizontalAlignment="Center" Margin="0,8,0,0"/>
                                            </StackPanel>
                                            <StackPanel x:Name="TrendColumn2" VerticalAlignment="Bottom" HorizontalAlignment="Center">
                                                <TextBlock x:Name="TrendCount2" Text="" Foreground="#70FFFFFF" FontSize="11" HorizontalAlignment="Center" Margin="0,0,0,4"/>
                                                <Border x:Name="TrendBar2" Width="48" CornerRadius="6,6,0,0" Height="4" Background="#8B5CF6"/>
                                                <TextBlock x:Name="TrendLabel2" Text="ä¸‰" Foreground="#8B5CF6" FontSize="12" FontWeight="SemiBold" HorizontalAlignment="Center" Margin="0,8,0,0"/>
                                            </StackPanel>
                                            <StackPanel x:Name="TrendColumn3" VerticalAlignment="Bottom" HorizontalAlignment="Center">
                                                <TextBlock x:Name="TrendCount3" Text="" Foreground="#70FFFFFF" FontSize="11" HorizontalAlignment="Center" Margin="0,0,0,4"/>
                                                <Border x:Name="TrendBar3" Width="48" CornerRadius="6,6,0,0" Height="4" Background="#3B82F6"/>
                                                <TextBlock x:Name="TrendLabel3" Text="å››" Foreground="#50FFFFFF" FontSize="12" HorizontalAlignment="Center" Margin="0,8,0,0"/>
                                            </StackPanel>
                                            <StackPanel x:Name="TrendColumn4" VerticalAlignment="Bottom" HorizontalAlignment="Center">
                                                <TextBlock x:Name="TrendCount4" Text="" Foreground="#70FFFFFF" FontSize="11" HorizontalAlignment="Center" Margin="0,0,0,4"/>
                                                <Border x:Name="TrendBar4" Width="48" CornerRadius="6,6,0,0" Height="4" Background="#3B82F6"/>
                                                <TextBlock x:Name="TrendLabel4" Text="äº”" Foreground="#50FFFFFF" FontSize="12" HorizontalAlignment="Center" Margin="0,8,0,0"/>
                                            </StackPanel>
                                            <StackPanel x:Name="TrendColumn5" VerticalAlignment="Bottom" HorizontalAlignment="Center">
                                                <TextBlock x:Name="TrendCount5" Text="" Foreground="#70FFFFFF" FontSize="11" HorizontalAlignment="Center" Margin="0,0,0,4"/>
                                                <Border x:Name="TrendBar5" Width="48" CornerRadius="6,6,0,0" Height="4" Background="#3B82F6"/>
                                                <TextBlock x:Name="TrendLabel5" Text="å…­" Foreground="#50FFFFFF" FontSize="12" HorizontalAlignment="Center" Margin="0,8,0,0"/>
                                            </StackPanel>
                                            <StackPanel x:Name="TrendColumn6" VerticalAlignment="Bottom" HorizontalAlignment="Center">
                                                <TextBlock x:Name="TrendCount6" Text="" Foreground="#70FFFFFF" FontSize="11" HorizontalAlignment="Center" Margin="0,0,0,4"/>
                                                <Border x:Name="TrendBar6" Width="48" CornerRadius="6,6,0,0" Height="4" Background="#3B82F6"/>
                                                <TextBlock x:Name="TrendLabel6" Text="æ—¥" Foreground="#50FFFFFF" FontSize="12" HorizontalAlignment="Center" Margin="0,8,0,0"/>
                                            </StackPanel>
                                        </UniformGrid>
                                    </StackPanel>
                                    
                                    <!-- é¼“åŠ±æ–‡å­— -->
                                    <StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="30,0,0,0" MinWidth="180">
                                        <TextBlock x:Name="EncourageText" Text="éžå¸¸é«˜æ•ˆï¼" Foreground="#22C55E" FontSize="15" FontWeight="SemiBold" 
                                                   TextWrapping="Wrap" TextAlignment="Right"/>
                                    </StackPanel>
                                </Grid>
                            </Border>
                            
                            <!-- ç¬¬ä¸‰è¡Œï¼šæ•ˆçŽ‡æ´žå¯Ÿ + åˆ†ç±»å æ¯” -->
                            <Grid Grid.Row="2">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <!-- æ•ˆçŽ‡æ´žå¯Ÿ -->
                                <Border Grid.Column="0" CornerRadius="16" Padding="24" Margin="0,0,10,0" Background="#10FFFFFF">
                                    <StackPanel>
                                        <TextBlock Text="æ•ˆçŽ‡æ´žå¯Ÿ" Foreground="White" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,20"/>
                                        
                                        <Grid Margin="0,0,0,12">
                                            <TextBlock Text="æ•ˆçŽ‡æœ€é«˜" Foreground="#80FFFFFF" FontSize="13"/>
                                            <TextBlock x:Name="ReviewBestDay" Text="å‘¨äºŒ (18é¡¹)" Foreground="White" FontSize="13" HorizontalAlignment="Right"/>
                                        </Grid>
                                        <Grid Margin="0,0,0,12">
                                            <TextBlock Text="æ—¥å‡å®Œæˆ" Foreground="#80FFFFFF" FontSize="13"/>
                                            <TextBlock x:Name="ReviewAvgDaily" Text="5.6 é¡¹" Foreground="White" FontSize="13" HorizontalAlignment="Right"/>
                                        </Grid>
                                        <Grid Margin="0,0,0,12">
                                            <TextBlock Text="æ€»é€¾æœŸ" Foreground="#EF4444" FontSize="13"/>
                                            <TextBlock x:Name="ReviewOverdueCount" Text="3 é¡¹" Foreground="#EF4444" FontSize="13" HorizontalAlignment="Right"/>
                                        </Grid>
                                        <Grid>
                                            <TextBlock Text="å·²é¡ºå»¶" Foreground="#F97316" FontSize="13"/>
                                            <TextBlock x:Name="ReviewPostponedCount" Text="10 é¡¹" Foreground="#F97316" FontSize="13" HorizontalAlignment="Right"/>
                                        </Grid>
                                    </StackPanel>
                                </Border>
                                
                                <!-- åˆ†ç±»å®Œæˆå æ¯” -->
                                <Border Grid.Column="1" CornerRadius="16" Padding="24" Margin="10,0,0,0" Background="#10FFFFFF">
                                    <StackPanel>
                                        <TextBlock Text="åˆ†ç±»å®Œæˆå æ¯”" Foreground="White" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,20"/>
                                        
                                        <StackPanel x:Name="ReviewCategoryStats">
                                            <!-- åŠ¨æ€ç”Ÿæˆåˆ†ç±»ç»Ÿè®¡æ¡å½¢å›¾ -->
                                        </StackPanel>
                                        
                                        <TextBlock x:Name="ReviewNoCategoryStats" Text="æš‚æ— åˆ†ç±»æ•°æ®" Foreground="#40FFFFFF" FontSize="12" 
                                                   HorizontalAlignment="Center" Margin="0,20,0,0" Visibility="Collapsed"/>
                                    </StackPanel>
                                </Border>
                            </Grid>
                        </Grid>
                    </ScrollViewer>
                    
                    <!-- éšè—çš„å…¼å®¹å…ƒç´  -->
                    <Border Visibility="Collapsed">
                        <StackPanel>
                            <TextBlock x:Name="ReviewTotalCount"/>
                            <Border x:Name="ReviewGroupSection"/>
                            <ItemsControl x:Name="ReviewGroupList"/>
                            <Border x:Name="ReviewHighBar"/>
                            <Border x:Name="ReviewMediumBar"/>
                            <Border x:Name="ReviewLowBar"/>
                            <TextBlock x:Name="ReviewHighCount"/>
                            <TextBlock x:Name="ReviewMediumCount"/>
                            <TextBlock x:Name="ReviewLowCount"/>
                            <TextBlock x:Name="LastWeekCount"/>
                            <TextBlock x:Name="ThisWeekCount"/>
                            <TextBlock x:Name="WeekCompareIcon"/>
                            <TextBlock x:Name="WeekCompareText"/>
                        </StackPanel>
                    </Border>
                </Grid>
            </Border>
            
            <!-- ========== é¡¹ç›®ç®¡ç†é¢æ¿ ========== -->
            <Border x:Name="ProjectPanel" Grid.Column="1" Visibility="Collapsed" Background="#FF101018">
                <Grid Margin="24,20">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- æ ‡é¢˜æ  -->
                    <Grid Grid.Row="0" Margin="0,0,0,24">
                        <StackPanel>
                            <TextBlock Text="ðŸ“ æˆ‘çš„åˆ†ç±»" Foreground="White" FontSize="28" FontWeight="Bold"/>
                            <TextBlock Text="æŠŠå¤§ç›®æ ‡æ‹†è§£æˆå°ä»»åŠ¡ï¼Œä¸€æ­¥æ­¥å®Œæˆ" Foreground="#50FFFFFF" FontSize="13" Margin="0,6,0,0"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,0,80,0">
                            <Button Content="ï¼‹ æ–°å»ºåˆ†ç±»" Background="#8B5CF6" Foreground="White"
                                    Padding="16,10" BorderThickness="0" Cursor="Hand" Click="AddProject_Click">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}" CornerRadius="8" Padding="{TemplateBinding Padding}">
                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                        </StackPanel>
                    </Grid>
                    
                    <!-- é¡¹ç›®åˆ—è¡¨ -->
                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                        <StackPanel>
                            <!-- é¡¹ç›®å¡ç‰‡åˆ—è¡¨ -->
                            <ItemsControl x:Name="ProjectList">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="#10FFFFFF" CornerRadius="12" Padding="20,16" Margin="0,0,0,12"
                                                Cursor="Hand" MouseLeftButtonDown="ProjectCard_Click" Tag="{Binding Id}">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                
                                                <!-- å›¾æ ‡ -->
                                                <Border Grid.Column="0" Width="48" Height="48" CornerRadius="12" Margin="0,0,16,0">
                                                    <Border.Background>
                                                        <SolidColorBrush Color="{Binding Color}" Opacity="0.2"/>
                                                    </Border.Background>
                                                    <TextBlock Text="{Binding Icon}" FontSize="24" 
                                                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                </Border>
                                                
                                                <!-- å†…å®¹ -->
                                                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                    <TextBlock Text="{Binding Name}" FontSize="16" FontWeight="SemiBold" Foreground="White"/>
                                                    <StackPanel Orientation="Horizontal" Margin="0,6,0,0">
                                                        <TextBlock FontSize="12" Foreground="#8B5CF6" FontWeight="SemiBold">
                                                            <Run Text="âœ… "/>
                                                            <Run Text="{Binding ProgressText, Mode=OneWay}"/>
                                                            <Run Text=" å®Œæˆ"/>
                                                        </TextBlock>
                                                        <TextBlock Text=" Â· " Foreground="#40FFFFFF" FontSize="12"
                                                                   Visibility="{Binding ConsecutiveDays, Converter={StaticResource NullToVisibilityConverter}}"/>
                                                        <TextBlock FontSize="12" Foreground="#F59E0B"
                                                                   Visibility="{Binding ConsecutiveDays, Converter={StaticResource NullToVisibilityConverter}}">
                                                            <Run Text="ðŸ”¥ è¿žç»­"/>
                                                            <Run Text="{Binding ConsecutiveDays, Mode=OneWay}"/>
                                                            <Run Text="å¤©"/>
                                                        </TextBlock>
                                                    </StackPanel>
                                                    <!-- æœ€è¿‘å®Œæˆ -->
                                                    <TextBlock FontSize="11" Foreground="#50FFFFFF" Margin="0,4,0,0"
                                                               Visibility="{Binding LatestCompletedTask, Converter={StaticResource NullToVisibilityConverter}}">
                                                        <Run Text="æœ€è¿‘ï¼šå®Œæˆäº†ã€Œ"/>
                                                        <Run Text="{Binding LatestCompletedTask.Title, Mode=OneWay}"/>
                                                        <Run Text="ã€"/>
                                                    </TextBlock>
                                                </StackPanel>
                                                
                                                <!-- ç®­å¤´ -->
                                                <TextBlock Grid.Column="2" Text="â€º" FontSize="24" Foreground="#40FFFFFF" 
                                                           VerticalAlignment="Center"/>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                            
                            <!-- ç©ºçŠ¶æ€ -->
                            <StackPanel x:Name="EmptyProjectState" Visibility="Collapsed" 
                                        HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0,60,0,0">
                                <Border Width="80" Height="80" CornerRadius="40" Background="#10FFFFFF" Margin="0,0,0,20">
                                    <TextBlock Text="ðŸ“" FontSize="36" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                <TextBlock Text="è¿˜æ²¡æœ‰åˆ†ç±»" Foreground="#60FFFFFF" FontSize="16" HorizontalAlignment="Center"/>
                                <TextBlock Text="ç‚¹å‡»ã€æ–°å»ºåˆ†ç±»ã€‘å¼€å§‹ä½ çš„ç¬¬ä¸€ä¸ªåˆ†ç±»" Foreground="#35FFFFFF" FontSize="12" 
                                           HorizontalAlignment="Center" Margin="0,8,0,0"/>
                            </StackPanel>
                        </StackPanel>
                    </ScrollViewer>
                </Grid>
            </Border>
            
            <!-- ========== é¡¹ç›®è¯¦æƒ…é¢æ¿ ========== -->
            <Border x:Name="ProjectDetailPanel" Grid.Column="1" Visibility="Collapsed" Background="#FF101018">
                <Grid Margin="24,20">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- è¿”å›ž + æ ‡é¢˜ + åˆ é™¤æŒ‰é’® -->
                    <Grid Grid.Row="0" Margin="0,0,0,20">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <!-- å·¦ä¾§ï¼šè¿”å›ž + å›¾æ ‡ + æ ‡é¢˜ -->
                        <StackPanel Grid.Column="0" Orientation="Horizontal">
                            <Button Content="â†" Style="{StaticResource IconButton}" 
                                    Click="BackToProjectList_Click" Foreground="#60FFFFFF" FontSize="18" Padding="8,6"
                                    ToolTip="è¿”å›žåˆ†ç±»åˆ—è¡¨"/>
                            <!-- å›¾æ ‡å®¹å™¨ -->
                            <Border Width="40" Height="40" CornerRadius="10" Margin="12,0,10,0" VerticalAlignment="Center">
                                <Border.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                        <GradientStop Color="#8B5CF6" Offset="0"/>
                                        <GradientStop Color="#6366F1" Offset="1"/>
                                    </LinearGradientBrush>
                                </Border.Background>
                                <TextBlock x:Name="ProjectDetailIcon" Text="ðŸ“" FontSize="20" 
                                           HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <!-- æ ‡é¢˜ -->
                            <TextBlock x:Name="ProjectDetailName" Text="åˆ†ç±»åç§°" FontSize="22" FontWeight="SemiBold" 
                                       Foreground="White" VerticalAlignment="Center"/>
                        </StackPanel>
                        
                        <!-- å³ä¾§ï¼šåˆ é™¤æŒ‰é’® -->
                        <Border Grid.Column="1" VerticalAlignment="Center" Margin="0,0,80,0"
                                CornerRadius="8" Padding="12,8" Cursor="Hand"
                                Background="#25EF4444" MouseLeftButtonDown="DeleteProject_Click"
                                ToolTip="åˆ é™¤æ­¤åˆ†ç±»">
                            <Border.Style>
                                <Style TargetType="Border">
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="#40EF4444"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </Border.Style>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="ðŸ—‘" FontSize="14" VerticalAlignment="Center" Foreground="#FF6B6B"/>
                                <TextBlock Text="åˆ é™¤" Foreground="#FF6B6B" FontSize="13" FontWeight="Medium" Margin="6,0,0,0" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                    </Grid>
                    
                    <!-- ç»Ÿè®¡å¡ç‰‡ -->
                    <Border Grid.Row="1" Background="#15FFFFFF" CornerRadius="12" Padding="24,20" Margin="0,0,0,20">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <StackPanel Grid.Column="0" HorizontalAlignment="Center">
                                <TextBlock x:Name="ProjectDetailProgress" Text="0/0" FontSize="48" FontWeight="Bold" 
                                           Foreground="#8B5CF6" HorizontalAlignment="Center"/>
                                <TextBlock Text="å·²å®Œæˆä»»åŠ¡" Foreground="#60FFFFFF" FontSize="13" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                            </StackPanel>
                            
                            <StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="40,0,0,0">
                                <TextBlock Foreground="#F59E0B" FontSize="14">
                                    <Run Text="ðŸ”¥ è¿žç»­æŽ¨è¿› "/>
                                    <Run x:Name="ProjectDetailDays" Text="0"/>
                                    <Run Text=" å¤©"/>
                                </TextBlock>
                            </StackPanel>
                        </Grid>
                    </Border>
                    
                    <!-- æˆé•¿è®°å½• -->
                    <Border Grid.Row="2" Margin="0,0,0,20">
                        <StackPanel>
                            <TextBlock Text="ðŸ“… æˆé•¿è®°å½•" FontSize="16" FontWeight="SemiBold" Foreground="White" Margin="0,0,0,12"/>
                            <ItemsControl x:Name="GrowthRecordList" MaxHeight="150">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                                            <TextBlock Text="{Binding Date}" FontSize="12" Foreground="#8B5CF6" FontWeight="SemiBold" Width="50"/>
                                            <TextBlock Text="{Binding Title}" Foreground="#80FFFFFF" FontSize="12"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                            <TextBlock x:Name="NoGrowthRecordText" Text="è¿˜æ²¡æœ‰å®Œæˆä»»ä½•ä»»åŠ¡ï¼ŒåŠ æ²¹ï¼" 
                                       Foreground="#40FFFFFF" FontSize="12" Visibility="Collapsed"/>
                        </StackPanel>
                    </Border>
                    
                    <!-- å…³è”å¾…åŠž -->
                    <Border Grid.Row="3" x:Name="LinkedTodosSection" Margin="0,0,0,20">
                        <StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                <TextBlock Text="ðŸ“‹ å…³è”å¾…åŠž" FontSize="16" FontWeight="SemiBold" Foreground="White"/>
                                <TextBlock x:Name="LinkedTodosHint" Text="ï¼ˆé€šè¿‡åˆ†ç»„æ·»åŠ ï¼‰" FontSize="12" Foreground="#50FFFFFF" 
                                           VerticalAlignment="Center" Margin="8,0,0,0"/>
                            </StackPanel>
                            <ItemsControl x:Name="LinkedTodosList" MaxHeight="200">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="#08FFFFFF" CornerRadius="8" Padding="14,10" Margin="0,0,0,6">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                
                                                <!-- å®ŒæˆçŠ¶æ€ -->
                                                <Border Grid.Column="0" Width="20" Height="20" CornerRadius="10" 
                                                        BorderBrush="#3B82F6" BorderThickness="2" Margin="0,0,12,0" 
                                                        Cursor="Hand" Tag="{Binding Id}"
                                                        Background="{Binding IsCompleted, Converter={StaticResource CompletedToBackgroundConverter}}"
                                                        MouseLeftButtonDown="ToggleLinkedTodo_Click">
                                                    <TextBlock Text="âœ“" Foreground="White" FontSize="10" FontWeight="Bold"
                                                               HorizontalAlignment="Center" VerticalAlignment="Center"
                                                               Visibility="{Binding IsCompleted, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                                </Border>
                                                
                                                <!-- å†…å®¹ -->
                                                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                    <TextBlock Text="{Binding Title}" FontSize="13"
                                                               Foreground="{Binding IsCompleted, Converter={StaticResource CompletedToForegroundConverter}}"
                                                               TextDecorations="{Binding IsCompleted, Converter={StaticResource CompletedToStrikethroughConverter}}"/>
                                                    <TextBlock Text="{Binding DueDateDisplay}" FontSize="10" Foreground="#50FFFFFF"
                                                               Visibility="{Binding DueDate, Converter={StaticResource NullToVisibilityConverter}}"
                                                               Margin="0,2,0,0"/>
                                                </StackPanel>
                                                
                                                <!-- ä¼˜å…ˆçº§æŒ‡ç¤º -->
                                                <Border Grid.Column="2" Width="8" Height="8" CornerRadius="4" VerticalAlignment="Center"
                                                        Background="{Binding Priority, Converter={StaticResource PriorityToColorConverter}}"/>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                            <TextBlock x:Name="NoLinkedTodosText" Text="æ·»åŠ å¾…åŠžæ—¶é€‰æ‹©æ­¤åˆ†ç±»å³å¯å…³è”" 
                                       Foreground="#40FFFFFF" FontSize="12" Visibility="Collapsed"/>
                        </StackPanel>
                    </Border>
                    
                    <!-- ä»»åŠ¡åˆ—è¡¨ -->
                    <Border Grid.Row="4">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            
                            <Grid Grid.Row="0" Margin="0,0,0,12">
                                <TextBlock Text="ðŸ“ åˆ†ç±»ä»»åŠ¡" FontSize="16" FontWeight="SemiBold" Foreground="White" VerticalAlignment="Center"/>
                                <Button Content="+ é€‰æ‹©çŽ°æœ‰å¾…åŠž" HorizontalAlignment="Right" Padding="12,6" Cursor="Hand"
                                        Click="SelectExistingTodo_Click" Background="#306366F1" Foreground="#C0FFFFFF" 
                                        BorderThickness="0" FontSize="12">
                                    <Button.Template>
                                        <ControlTemplate TargetType="Button">
                                            <Border x:Name="Bd" Background="{TemplateBinding Background}" CornerRadius="6" Padding="{TemplateBinding Padding}">
                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter TargetName="Bd" Property="Background" Value="#506366F1"/>
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Button.Template>
                                </Button>
                            </Grid>
                            
                            <!-- æ·»åŠ ä»»åŠ¡è¾“å…¥æ¡† -->
                            <Border Grid.Row="1" Background="#10FFFFFF" CornerRadius="8" Padding="4" Margin="0,0,0,12">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBox x:Name="ProjectTaskInput" Grid.Column="0" Background="Transparent" BorderThickness="0"
                                             Foreground="White" FontSize="14" Padding="12,10" VerticalAlignment="Center"
                                             KeyDown="ProjectTaskInput_KeyDown" CaretBrush="White">
                                        <TextBox.Style>
                                            <Style TargetType="TextBox">
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="TextBox">
                                                            <Grid>
                                                                <ScrollViewer x:Name="PART_ContentHost"/>
                                                                <TextBlock Text="+ æ·»åŠ æ–°ä»»åŠ¡ï¼ŒæŒ‰Enterç¡®è®¤" Foreground="#40FFFFFF" 
                                                                           VerticalAlignment="Center" Margin="12,0,0,0"
                                                                           Visibility="{Binding Text.IsEmpty, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                                            </Grid>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </Style>
                                        </TextBox.Style>
                                    </TextBox>
                                    <Button Grid.Column="1" Content="æ·»åŠ " Padding="16,8" Margin="4" Cursor="Hand"
                                            Click="AddProjectTask_Click" Background="#8B5CF6" Foreground="White" BorderThickness="0">
                                        <Button.Template>
                                            <ControlTemplate TargetType="Button">
                                                <Border Background="{TemplateBinding Background}" CornerRadius="6" Padding="{TemplateBinding Padding}">
                                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                </Border>
                                            </ControlTemplate>
                                        </Button.Template>
                                    </Button>
                                </Grid>
                            </Border>
                            
                            <!-- ä»»åŠ¡åˆ—è¡¨ -->
                            <ScrollViewer Grid.Row="2" VerticalScrollBarVisibility="Auto">
                                <ItemsControl x:Name="ProjectTaskList">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border Background="#08FFFFFF" CornerRadius="8" Padding="14,12" Margin="0,0,0,6">
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    
                                                    <!-- å®ŒæˆæŒ‰é’® -->
                                                    <Border Grid.Column="0" Width="22" Height="22" CornerRadius="11" 
                                                            BorderBrush="#8B5CF6" BorderThickness="2" Margin="0,0,12,0" 
                                                            Cursor="Hand" Tag="{Binding Id}"
                                                            Background="{Binding IsCompleted, Converter={StaticResource CompletedToBackgroundConverter}}"
                                                            MouseLeftButtonDown="ToggleProjectTask_Click">
                                                        <TextBlock Text="âœ“" Foreground="White" FontSize="11" FontWeight="Bold"
                                                                   HorizontalAlignment="Center" VerticalAlignment="Center"
                                                                   Visibility="{Binding IsCompleted, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                                    </Border>
                                                    
                                                    <!-- ä»»åŠ¡åç§° -->
                                                    <TextBlock Grid.Column="1" Text="{Binding Title}" FontSize="14" VerticalAlignment="Center"
                                                               Foreground="{Binding IsCompleted, Converter={StaticResource CompletedToForegroundConverter}}"
                                                               TextDecorations="{Binding IsCompleted, Converter={StaticResource CompletedToStrikethroughConverter}}"/>
                                                    
                                                    <!-- åˆ é™¤æŒ‰é’® -->
                                                    <Button Grid.Column="2" Content="âœ•" Style="{StaticResource IconButton}" 
                                                            FontSize="11" Tag="{Binding Id}" Click="DeleteProjectTask_Click"
                                                            Foreground="#40FFFFFF" ToolTip="åˆ é™¤ä»»åŠ¡"/>
                                                </Grid>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </ScrollViewer>
                        </Grid>
                    </Border>
                </Grid>
            </Border>
            
            <!-- ========== æ—¥è®°é¢æ¿ ========== -->
            <Border x:Name="DiaryPanel" Grid.Column="1" Visibility="Collapsed" Background="#FF0D0D12">
                <Grid Margin="48,0,48,32">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- æ ‡é¢˜æ  -->
                    <Grid Grid.Row="0" Margin="0,28,0,24">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <StackPanel Grid.Column="0" Orientation="Horizontal">
                            <Border Width="40" Height="40" CornerRadius="10" Margin="0,0,14,0">
                                <Border.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                        <GradientStop Color="#F59E0B" Offset="0"/>
                                        <GradientStop Color="#EAB308" Offset="1"/>
                                    </LinearGradientBrush>
                                </Border.Background>
                                <TextBlock Text="ðŸ“" FontSize="20" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <StackPanel VerticalAlignment="Center">
                                <TextBlock Text="æˆ‘çš„æ—¥è®°" FontSize="24" FontWeight="Bold" Foreground="White"/>
                                <TextBlock x:Name="DiaryCountText" Text="è®°å½•ä½ çš„æ¯ä¸€ä¸ªæƒ³æ³•" Foreground="#60FFFFFF" FontSize="12" Margin="0,2,0,0"/>
                            </StackPanel>
                        </StackPanel>
                        
                        <!-- æœç´¢æ¡† -->
                        <Border Grid.Column="1" Background="#15FFFFFF" CornerRadius="8" Padding="12,8" Width="220">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="ðŸ”" FontSize="14" Foreground="#60FFFFFF" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                <TextBox x:Name="DiarySearchBox" Grid.Column="1" Background="Transparent" BorderThickness="0"
                                         Foreground="White" FontSize="13" VerticalAlignment="Center" CaretBrush="#F59E0B"
                                         TextChanged="DiarySearch_TextChanged">
                                    <TextBox.Style>
                                        <Style TargetType="TextBox">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="TextBox">
                                                        <Grid>
                                                            <ScrollViewer x:Name="PART_ContentHost"/>
                                                            <TextBlock Text="æœç´¢æ—¥è®°..." Foreground="#40FFFFFF" 
                                                                       VerticalAlignment="Center"
                                                                       Visibility="{Binding Text.IsEmpty, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                                        </Grid>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                    </TextBox.Style>
                                </TextBox>
                            </Grid>
                        </Border>
                    </Grid>
                    
                    <!-- å¿«é€Ÿæ·»åŠ åŒº -->
                    <Border Grid.Row="1" Background="#15FFFFFF" CornerRadius="12" Padding="20" Margin="0,0,0,24">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <TextBox x:Name="DiaryInput" Grid.Row="0" Background="Transparent" BorderThickness="0"
                                     Foreground="White" FontSize="14" AcceptsReturn="True" TextWrapping="Wrap"
                                     Height="80" VerticalScrollBarVisibility="Auto" CaretBrush="#F59E0B"
                                     KeyDown="DiaryInput_KeyDown" TextChanged="DiaryInput_TextChanged">
                                <TextBox.Style>
                                    <Style TargetType="TextBox">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="TextBox">
                                                    <Grid>
                                                        <ScrollViewer x:Name="PART_ContentHost"/>
                                                        <TextBlock Text="è®°å½•ä½ çš„æƒ³æ³•...ï¼ˆCtrl+Enter æäº¤ï¼‰" Foreground="#40FFFFFF" 
                                                                   VerticalAlignment="Top" Margin="0,2,0,0"
                                                                   Visibility="{Binding Text.IsEmpty, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                                    </Grid>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </TextBox.Style>
                            </TextBox>
                            
                            <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,12,0,0">
                                <TextBlock x:Name="DiaryInputCount" Text="0 å­—" Foreground="#40FFFFFF" FontSize="12" VerticalAlignment="Center" Margin="0,0,16,0"/>
                                <Button Content="æ·»åŠ æ—¥è®°" Padding="20,10" Cursor="Hand"
                                        Click="SubmitDiary_Click" Background="#F59E0B" Foreground="White" BorderThickness="0">
                                    <Button.Template>
                                        <ControlTemplate TargetType="Button">
                                            <Border x:Name="Bd" Background="{TemplateBinding Background}" CornerRadius="8" Padding="{TemplateBinding Padding}">
                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter TargetName="Bd" Property="Background" Value="#EAB308"/>
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Button.Template>
                                </Button>
                            </StackPanel>
                        </Grid>
                    </Border>
                    
                    <!-- æ—¥è®°åˆ—è¡¨ï¼ˆæŒ‰å¤©åˆ†ç»„ï¼‰ -->
                    <ScrollViewer Grid.Row="2" VerticalScrollBarVisibility="Auto">
                        <ItemsControl x:Name="DiaryList">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <StackPanel Margin="0,0,0,24">
                                        <!-- æ—¥æœŸåˆ†ç»„å¤´ -->
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                            <Border Background="#25F59E0B" CornerRadius="6" Padding="12,6">
                                                <TextBlock Text="{Binding DateDisplay}" FontSize="14" FontWeight="SemiBold" Foreground="#F59E0B"/>
                                            </Border>
                                            <TextBlock Text="{Binding Entries.Count, StringFormat={}{0} æ¡è®°å½•}" 
                                                       Foreground="#40FFFFFF" FontSize="12" VerticalAlignment="Center" Margin="12,0,0,0"/>
                                        </StackPanel>
                                        
                                        <!-- å½“å¤©çš„æ—¥è®°æ¡ç›® -->
                                        <ItemsControl ItemsSource="{Binding Entries}">
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <Border Background="#10FFFFFF" CornerRadius="10" Padding="16,14" Margin="0,0,0,8"
                                                            Tag="{Binding Id}">
                                                        <Border.Style>
                                                            <Style TargetType="Border">
                                                                <Style.Triggers>
                                                                    <Trigger Property="IsMouseOver" Value="True">
                                                                        <Setter Property="Background" Value="#18FFFFFF"/>
                                                                    </Trigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Border.Style>
                                                        <Grid>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="Auto"/>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                            </Grid.ColumnDefinitions>
                                                            
                                                            <!-- æ—¶é—´ -->
                                                            <StackPanel Grid.Column="0" VerticalAlignment="Top" Margin="0,0,16,0">
                                                                <TextBlock Text="{Binding TimeDisplay}" FontSize="14" FontWeight="SemiBold" Foreground="#F59E0B"/>
                                                                <TextBlock Text="{Binding WordCount, StringFormat={}{0}å­—}" FontSize="11" Foreground="#40FFFFFF" Margin="0,4,0,0"/>
                                                            </StackPanel>
                                                            
                                                            <!-- å†…å®¹ -->
                                                            <TextBlock Grid.Column="1" Text="{Binding Content}" FontSize="14" Foreground="#E0FFFFFF"
                                                                       TextWrapping="Wrap" MaxHeight="120" TextTrimming="CharacterEllipsis"/>
                                                            
                                                            <!-- æ“ä½œæŒ‰é’® -->
                                                            <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Top" Margin="16,0,0,0">
                                                                <Button Content="âœï¸" Style="{StaticResource IconButton}" FontSize="12" Padding="6" 
                                                                        Tag="{Binding Id}" Click="EditDiary_Click" ToolTip="ç¼–è¾‘"/>
                                                                <Button Content="ðŸ—‘ï¸" Style="{StaticResource IconButton}" FontSize="12" Padding="6" 
                                                                        Tag="{Binding Id}" Click="DeleteDiary_Click" ToolTip="åˆ é™¤"/>
                                                            </StackPanel>
                                                        </Grid>
                                                    </Border>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                    </StackPanel>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                    
                    <!-- ç©ºçŠ¶æ€æç¤º -->
                    <StackPanel x:Name="DiaryEmptyState" Grid.Row="2" VerticalAlignment="Center" HorizontalAlignment="Center" 
                                Visibility="Collapsed">
                        <TextBlock Text="ðŸ“" FontSize="48" HorizontalAlignment="Center" Opacity="0.5"/>
                        <TextBlock Text="è¿˜æ²¡æœ‰æ—¥è®°" FontSize="16" Foreground="#60FFFFFF" HorizontalAlignment="Center" Margin="0,12,0,0"/>
                        <TextBlock Text="å¼€å§‹è®°å½•ä½ çš„æƒ³æ³•å§ï¼" FontSize="13" Foreground="#40FFFFFF" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                    </StackPanel>
                </Grid>
            </Border>
            
            <!-- ========== ç¼–è¾‘æ—¥è®°å¼¹çª— ========== -->
            <Border x:Name="EditDiaryPopup" Grid.ColumnSpan="2" Visibility="Collapsed">
                <Border.Background>
                    <SolidColorBrush Color="#000000" Opacity="0.85"/>
                </Border.Background>
                <Border CornerRadius="16" Width="560" VerticalAlignment="Center" HorizontalAlignment="Center"
                        Padding="32" BorderBrush="#30FFFFFF" BorderThickness="1" Background="#FF1A1A22">
                    <StackPanel>
                        <Grid Margin="0,0,0,24">
                            <StackPanel Orientation="Horizontal">
                                <Border Width="32" Height="32" CornerRadius="8" Background="#30F59E0B" Margin="0,0,12,0">
                                    <TextBlock Text="âœï¸" Foreground="White" FontSize="16" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                <TextBlock Text="ç¼–è¾‘æ—¥è®°" Foreground="White" FontSize="20" FontWeight="Bold" VerticalAlignment="Center"/>
                            </StackPanel>
                            <Button Content="Ã—" HorizontalAlignment="Right" Style="{StaticResource IconButton}" 
                                    FontSize="22" Click="CloseEditDiaryPopup_Click"/>
                        </Grid>
                        
                        <!-- å†…å®¹ç¼–è¾‘ -->
                        <TextBlock Text="å†…å®¹" Foreground="#AAAAAA" FontSize="12" FontWeight="Medium" Margin="0,0,0,8"/>
                        <Border Background="#FF252530" CornerRadius="10" Padding="16,14" Margin="0,0,0,20" BorderBrush="#40FFFFFF" BorderThickness="1">
                            <TextBox x:Name="EditDiaryContent" Background="Transparent" BorderThickness="0"
                                     Foreground="White" FontSize="14" CaretBrush="#F59E0B" AcceptsReturn="True" 
                                     TextWrapping="Wrap" Height="200" VerticalScrollBarVisibility="Auto"/>
                        </Border>
                        
                        <!-- æŒ‰é’® -->
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                            <Button Content="å–æ¶ˆ" Style="{StaticResource IconButton}" Padding="20,10"
                                    Click="CloseEditDiaryPopup_Click" Foreground="#80FFFFFF"/>
                            <Button Content="ä¿å­˜" Padding="24,10" Margin="12,0,0,0" Cursor="Hand"
                                    Click="ConfirmEditDiary_Click" Background="#F59E0B" Foreground="White" BorderThickness="0">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}" CornerRadius="8" Padding="{TemplateBinding Padding}">
                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                        </StackPanel>
                    </StackPanel>
                </Border>
            </Border>
            
            <!-- ========== æ–°å»ºé¡¹ç›®å¼¹çª— ========== -->
            <Border x:Name="AddProjectPopup" Grid.ColumnSpan="2" Visibility="Collapsed">
                <Border.Background>
                    <SolidColorBrush Color="#000000" Opacity="0.85"/>
                </Border.Background>
                <Border CornerRadius="16" Width="420" VerticalAlignment="Center" HorizontalAlignment="Center"
                        Padding="32" BorderBrush="#30FFFFFF" BorderThickness="1" Background="#FF1A1A22">
                    <StackPanel>
                        <TextBlock Text="ðŸ“ æ–°å»ºåˆ†ç±»" FontSize="20" FontWeight="Bold" Foreground="White" Margin="0,0,0,24"/>
                        
                        <!-- åˆ†ç±»åç§° -->
                        <TextBlock Text="åˆ†ç±»åç§°" Foreground="#80FFFFFF" FontSize="12" Margin="0,0,0,8"/>
                        <Border Background="#15FFFFFF" CornerRadius="8" Padding="4" Margin="0,0,0,16">
                            <TextBox x:Name="NewProjectName" Background="Transparent" BorderThickness="0"
                                     Foreground="White" FontSize="14" Padding="12,10" CaretBrush="White"/>
                        </Border>
                        
                        <!-- é€‰æ‹©å›¾æ ‡ -->
                        <TextBlock Text="é€‰æ‹©å›¾æ ‡" Foreground="#80FFFFFF" FontSize="12" Margin="0,0,0,8"/>
                        <WrapPanel x:Name="ProjectIconList" Margin="0,0,0,16">
                            <Border Width="40" Height="40" CornerRadius="8" Margin="0,0,8,8" Cursor="Hand" Background="#20FFFFFF"
                                    MouseLeftButtonDown="SelectProjectIcon_Click" Tag="ðŸ“"><TextBlock Text="ðŸ“" FontSize="20" HorizontalAlignment="Center" VerticalAlignment="Center"/></Border>
                            <Border Width="40" Height="40" CornerRadius="8" Margin="0,0,8,8" Cursor="Hand" Background="#20FFFFFF"
                                    MouseLeftButtonDown="SelectProjectIcon_Click" Tag="ðŸ“±"><TextBlock Text="ðŸ“±" FontSize="20" HorizontalAlignment="Center" VerticalAlignment="Center"/></Border>
                            <Border Width="40" Height="40" CornerRadius="8" Margin="0,0,8,8" Cursor="Hand" Background="#20FFFFFF"
                                    MouseLeftButtonDown="SelectProjectIcon_Click" Tag="ðŸ’»"><TextBlock Text="ðŸ’»" FontSize="20" HorizontalAlignment="Center" VerticalAlignment="Center"/></Border>
                            <Border Width="40" Height="40" CornerRadius="8" Margin="0,0,8,8" Cursor="Hand" Background="#20FFFFFF"
                                    MouseLeftButtonDown="SelectProjectIcon_Click" Tag="ðŸ“š"><TextBlock Text="ðŸ“š" FontSize="20" HorizontalAlignment="Center" VerticalAlignment="Center"/></Border>
                            <Border Width="40" Height="40" CornerRadius="8" Margin="0,0,8,8" Cursor="Hand" Background="#20FFFFFF"
                                    MouseLeftButtonDown="SelectProjectIcon_Click" Tag="ðŸŽ¨"><TextBlock Text="ðŸŽ¨" FontSize="20" HorizontalAlignment="Center" VerticalAlignment="Center"/></Border>
                            <Border Width="40" Height="40" CornerRadius="8" Margin="0,0,8,8" Cursor="Hand" Background="#20FFFFFF"
                                    MouseLeftButtonDown="SelectProjectIcon_Click" Tag="ðŸŽ®"><TextBlock Text="ðŸŽ®" FontSize="20" HorizontalAlignment="Center" VerticalAlignment="Center"/></Border>
                            <Border Width="40" Height="40" CornerRadius="8" Margin="0,0,8,8" Cursor="Hand" Background="#20FFFFFF"
                                    MouseLeftButtonDown="SelectProjectIcon_Click" Tag="ðŸ "><TextBlock Text="ðŸ " FontSize="20" HorizontalAlignment="Center" VerticalAlignment="Center"/></Border>
                            <Border Width="40" Height="40" CornerRadius="8" Margin="0,0,8,8" Cursor="Hand" Background="#20FFFFFF"
                                    MouseLeftButtonDown="SelectProjectIcon_Click" Tag="âœˆï¸"><TextBlock Text="âœˆï¸" FontSize="20" HorizontalAlignment="Center" VerticalAlignment="Center"/></Border>
                        </WrapPanel>
                        
                        <!-- æŒ‰é’® -->
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,8,0,0">
                            <Button Content="å–æ¶ˆ" Style="{StaticResource IconButton}" Padding="20,10"
                                    Click="CloseAddProjectPopup_Click" Foreground="#80FFFFFF"/>
                            <Button Content="åˆ›å»ºåˆ†ç±»" Padding="24,10" Margin="12,0,0,0" Cursor="Hand"
                                    Click="ConfirmAddProject_Click" Background="#8B5CF6" Foreground="White" BorderThickness="0">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}" CornerRadius="8" Padding="{TemplateBinding Padding}">
                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                        </StackPanel>
                    </StackPanel>
                </Border>
            </Border>
            
            <!-- ========== é€‰æ‹©çŽ°æœ‰å¾…åŠžå¼¹çª— ========== -->
            <Border x:Name="SelectExistingTodoPopup" Grid.ColumnSpan="2" Visibility="Collapsed">
                <Border.Background>
                    <SolidColorBrush Color="#000000" Opacity="0.85"/>
                </Border.Background>
                <Border CornerRadius="16" Width="500" MaxHeight="600" VerticalAlignment="Center" HorizontalAlignment="Center"
                        Padding="28" BorderBrush="#30FFFFFF" BorderThickness="1" Background="#FF1A1A22">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <!-- æ ‡é¢˜ -->
                        <Grid Grid.Row="0" Margin="0,0,0,20">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="ðŸ“‹" FontSize="20" Margin="0,0,10,0"/>
                                <TextBlock Text="é€‰æ‹©çŽ°æœ‰å¾…åŠž" FontSize="18" FontWeight="Bold" Foreground="White" VerticalAlignment="Center"/>
                            </StackPanel>
                            <Button Content="Ã—" HorizontalAlignment="Right" Style="{StaticResource IconButton}" 
                                    FontSize="22" Click="CloseSelectTodoPopup_Click"/>
                        </Grid>
                        
                        <!-- æç¤º -->
                        <TextBlock Grid.Row="1" Text="é€‰æ‹©è¦æ·»åŠ åˆ°æ­¤åˆ†ç±»çš„å¾…åŠžä»»åŠ¡ï¼ˆå·²å®Œæˆæˆ–è¿›è¡Œä¸­ï¼‰" 
                                   Foreground="#60FFFFFF" FontSize="12" Margin="0,0,0,16"/>
                        
                        <!-- å¾…åŠžåˆ—è¡¨ -->
                        <ScrollViewer Grid.Row="2" VerticalScrollBarVisibility="Auto" MaxHeight="400">
                            <ItemsControl x:Name="SelectableTodoList">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="#10FFFFFF" CornerRadius="10" Padding="14,12" Margin="0,0,0,8" 
                                                Cursor="Hand" Tag="{Binding Id}" MouseLeftButtonDown="SelectTodoItem_Click">
                                            <Border.Style>
                                                <Style TargetType="Border">
                                                    <Style.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter Property="Background" Value="#20FFFFFF"/>
                                                        </Trigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Border.Style>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                
                                                <!-- å®ŒæˆçŠ¶æ€å›¾æ ‡ -->
                                                <Border Grid.Column="0" Width="24" Height="24" CornerRadius="12" Margin="0,0,12,0"
                                                        BorderBrush="#8B5CF6"
                                                        Background="{Binding IsCompleted, Converter={StaticResource CompletedToBackgroundConverter}}"
                                                        BorderThickness="2">
                                                    <TextBlock Text="âœ“" Foreground="White" FontSize="11" FontWeight="Bold"
                                                               HorizontalAlignment="Center" VerticalAlignment="Center"
                                                               Visibility="{Binding IsCompleted, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                                </Border>
                                                
                                                <!-- ä»»åŠ¡ä¿¡æ¯ -->
                                                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                    <TextBlock Text="{Binding Title}" FontSize="14" Foreground="White" 
                                                               TextTrimming="CharacterEllipsis"/>
                                                    <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                                        <TextBlock Text="{Binding DueDateDisplay}" FontSize="11" Foreground="#50FFFFFF"
                                                                   Visibility="{Binding DueDate, Converter={StaticResource NullToVisibilityConverter}}"/>
                                                    </StackPanel>
                                                </StackPanel>
                                                
                                                <!-- ä¼˜å…ˆçº§æ ‡è®° -->
                                                <Border Grid.Column="2" Width="10" Height="10" CornerRadius="5" VerticalAlignment="Center"
                                                        Background="{Binding Priority, Converter={StaticResource PriorityToColorConverter}}"/>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                        
                        <!-- æ— å¾…åŠžæç¤º -->
                        <TextBlock x:Name="NoSelectableTodosText" Grid.Row="2" Text="æ²¡æœ‰å¯æ·»åŠ çš„å¾…åŠžä»»åŠ¡" 
                                   Foreground="#40FFFFFF" FontSize="14" HorizontalAlignment="Center" VerticalAlignment="Center"
                                   Visibility="Collapsed"/>
                    </Grid>
                </Border>
            </Border>
            
            <!-- ========== æ·»åŠ å­ä»»åŠ¡å¼¹çª— ========== -->
            <Popup x:Name="SubTaskPopup" Placement="Center" StaysOpen="False" AllowsTransparency="True"
                   PlacementTarget="{Binding ElementName=TodoList}">
                <Border Background="#FF1A1A22" CornerRadius="12" Padding="20" 
                        BorderBrush="#30FFFFFF" BorderThickness="1" Width="380">
                    <Border.Effect>
                        <DropShadowEffect Color="Black" BlurRadius="20" Opacity="0.5"/>
                    </Border.Effect>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <!-- éšè—çš„çˆ¶ä»»åŠ¡ID -->
                        <TextBlock x:Name="SubTaskParentId" Visibility="Collapsed"/>
                        
                        <!-- æ ‡é¢˜ -->
                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,16">
                            <TextBlock Text="ðŸ“‹" FontSize="18" Margin="0,0,10,0"/>
                            <TextBlock Text="æ·»åŠ å­ä»»åŠ¡" FontSize="16" FontWeight="SemiBold" Foreground="White"/>
                            <Button Content="âœ•" Style="{StaticResource IconButton}" HorizontalAlignment="Right"
                                    Click="CloseSubTaskPopup_Click" Margin="180,0,0,0" Foreground="#80FFFFFF"/>
                        </StackPanel>
                        
                        <!-- è¾“å…¥æ¡† -->
                        <Border Grid.Row="1" Background="#15FFFFFF" CornerRadius="8" Padding="2" Margin="0,0,0,16">
                            <TextBox x:Name="SubTaskInput" Background="Transparent" BorderThickness="0"
                                     Foreground="White" FontSize="14" Padding="12,10"
                                     KeyDown="SubTaskInput_KeyDown">
                                <TextBox.Style>
                                    <Style TargetType="TextBox">
                                        <Setter Property="CaretBrush" Value="White"/>
                                    </Style>
                                </TextBox.Style>
                            </TextBox>
                        </Border>
                        
                        <!-- æŒ‰é’® -->
                        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right">
                            <Button Content="å–æ¶ˆ" Style="{StaticResource IconButton}" Padding="16,8"
                                    Click="CloseSubTaskPopup_Click" Foreground="#80FFFFFF"/>
                            <Button Content="æ·»åŠ " Padding="20,8" Margin="10,0,0,0" Cursor="Hand"
                                    Click="ConfirmAddSubTask_Click" FontWeight="SemiBold">
                                <Button.Style>
                                    <Style TargetType="Button">
                                        <Setter Property="Background" Value="#3B82F6"/>
                                        <Setter Property="Foreground" Value="White"/>
                                        <Setter Property="BorderThickness" Value="0"/>
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="Button">
                                                    <Border Background="{TemplateBinding Background}" 
                                                            CornerRadius="8" Padding="{TemplateBinding Padding}">
                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                    </Border>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="#2563EB"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>
                        </StackPanel>
                    </Grid>
                </Border>
            </Popup>
            
            <!-- ========== ç¼–è¾‘å¼¹çª— ========== -->
            <Border x:Name="EditPopup" Grid.ColumnSpan="2" Visibility="Collapsed">
                <Border.Background>
                    <SolidColorBrush Color="#000000" Opacity="0.85"/>
                </Border.Background>
                <Border CornerRadius="16" Width="480" VerticalAlignment="Center" HorizontalAlignment="Center"
                        Padding="36" BorderBrush="#50FFFFFF" BorderThickness="1" Background="#FF1A1A22">
                    <StackPanel>
                        <Grid Margin="0,0,0,28">
                            <StackPanel Orientation="Horizontal">
                                <Border Width="32" Height="32" CornerRadius="8" Background="#306366F1" Margin="0,0,12,0">
                                    <TextBlock Text="âœŽ" Foreground="White" FontSize="16" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                <TextBlock Text="ç¼–è¾‘å¾…åŠž" Foreground="White" FontSize="22" FontWeight="Bold" VerticalAlignment="Center"/>
                            </StackPanel>
                            <Button Content="Ã—" HorizontalAlignment="Right" Style="{StaticResource IconButton}" 
                                    FontSize="24" Click="CloseEditPopup_Click"/>
                        </Grid>
                        
                        <!-- æ ‡é¢˜ -->
                        <TextBlock Text="æ ‡é¢˜" Foreground="#AAAAAA" FontSize="12" FontWeight="Medium" Margin="0,0,0,8"/>
                        <Border Background="#FF252530" CornerRadius="10" Padding="16,14" Margin="0,0,0,20" BorderBrush="#40FFFFFF" BorderThickness="1">
                            <TextBox x:Name="EditTitleBox" Background="Transparent" BorderThickness="0"
                                     Foreground="White" FontSize="15" CaretBrush="#8B5CF6" FontWeight="Medium"/>
                        </Border>
                        
                        <!-- ä¼˜å…ˆçº§ -->
                        <TextBlock Text="ä¼˜å…ˆçº§" Foreground="#AAAAAA" FontSize="12" FontWeight="Medium" Margin="0,0,0,8"/>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                            <Border x:Name="EditPriorityHigh" Background="#40EF4444" BorderBrush="#EF4444" BorderThickness="2" 
                                    CornerRadius="8" Padding="16,10" Margin="0,0,10,0" Cursor="Hand" MouseLeftButtonDown="EditPriority_Select" Tag="High">
                                <StackPanel Orientation="Horizontal">
                                    <Ellipse Width="8" Height="8" Fill="#EF4444" Margin="0,0,8,0"/>
                                    <TextBlock Text="ç´§æ€¥" Foreground="#FF6B6B" FontSize="13" FontWeight="SemiBold"/>
                                </StackPanel>
                            </Border>
                            <Border x:Name="EditPriorityMedium" Background="#40F59E0B" BorderBrush="#F59E0B" BorderThickness="2" 
                                    CornerRadius="8" Padding="16,10" Margin="0,0,10,0" Cursor="Hand" MouseLeftButtonDown="EditPriority_Select" Tag="Medium">
                                <StackPanel Orientation="Horizontal">
                                    <Ellipse Width="8" Height="8" Fill="#F59E0B" Margin="0,0,8,0"/>
                                    <TextBlock Text="é‡è¦" Foreground="#FFB347" FontSize="13" FontWeight="SemiBold"/>
                                </StackPanel>
                            </Border>
                            <Border x:Name="EditPriorityLow" Background="#4022C55E" BorderBrush="#22C55E" BorderThickness="2" 
                                    CornerRadius="8" Padding="16,10" Cursor="Hand" MouseLeftButtonDown="EditPriority_Select" Tag="Low">
                                <StackPanel Orientation="Horizontal">
                                    <Ellipse Width="8" Height="8" Fill="#22C55E" Margin="0,0,8,0"/>
                                    <TextBlock Text="æ™®é€š" Foreground="#4ADE80" FontSize="13" FontWeight="SemiBold"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                        
                        <!-- æˆªæ­¢æ—¥æœŸ & æ—¶é—´ -->
                        <TextBlock Text="æˆªæ­¢æ—¥æœŸ" Foreground="#AAAAAA" FontSize="12" FontWeight="Medium" Margin="0,0,0,8"/>
                        <Grid Margin="0,0,0,20">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="110"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- æ—¥æœŸé€‰æ‹© -->
                            <Border Grid.Column="0" Background="#FF252530" CornerRadius="10" Margin="0,0,10,0" BorderBrush="#40FFFFFF" BorderThickness="1">
                                <DatePicker x:Name="EditDatePicker" BorderThickness="0" FontSize="14" Padding="16,12" Foreground="White">
                                    <DatePicker.Resources>
                                        <Style TargetType="DatePickerTextBox">
                                            <Setter Property="Foreground" Value="White"/>
                                            <Setter Property="Background" Value="Transparent"/>
                                            <Setter Property="CaretBrush" Value="#8B5CF6"/>
                                            <Setter Property="Control.Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="DatePickerTextBox">
                                                        <Grid>
                                                            <TextBox x:Name="PART_TextBox" Background="Transparent" BorderThickness="0"
                                                                     Foreground="White" FontSize="14"
                                                                     Text="{Binding Path=Text, RelativeSource={RelativeSource TemplatedParent}, Mode=TwoWay}"/>
                                                            <TextBlock Text="é€‰æ‹©æ—¥æœŸ" Foreground="#555555" FontSize="14" VerticalAlignment="Center"
                                                                       IsHitTestVisible="False">
                                                                <TextBlock.Style>
                                                                    <Style TargetType="TextBlock">
                                                                        <Setter Property="Visibility" Value="Collapsed"/>
                                                                        <Style.Triggers>
                                                                            <DataTrigger Binding="{Binding Text, ElementName=PART_TextBox}" Value="">
                                                                                <Setter Property="Visibility" Value="Visible"/>
                                                                            </DataTrigger>
                                                                        </Style.Triggers>
                                                                    </Style>
                                                                </TextBlock.Style>
                                                            </TextBlock>
                                                        </Grid>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                    </DatePicker.Resources>
                                </DatePicker>
                            </Border>
                            
                            <!-- æ—¶é—´é€‰æ‹© -->
                            <Grid Grid.Column="1">
                                <Button x:Name="TimePickerButton" Click="TimePickerButton_Click" Cursor="Hand">
                                    <Button.Template>
                                        <ControlTemplate TargetType="Button">
                                            <Border Background="#FF252530" CornerRadius="10" BorderBrush="#40FFFFFF" BorderThickness="1" Padding="16,12">
                                                <TextBlock x:Name="TimeDisplay" Text="æ—¶é—´" Foreground="#888888" FontSize="14" 
                                                           HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                        </ControlTemplate>
                                    </Button.Template>
                                </Button>
                                <Popup x:Name="TimePopup" PlacementTarget="{Binding ElementName=TimePickerButton}" 
                                       Placement="Bottom" StaysOpen="False" AllowsTransparency="True">
                                    <Border Background="#FF1E1E28" BorderBrush="#50FFFFFF" BorderThickness="1" 
                                            CornerRadius="10" Margin="0,4,0,0" Padding="6">
                                        <ScrollViewer MaxHeight="220" VerticalScrollBarVisibility="Auto">
                                            <StackPanel>
                                                <Button Tag="08:00" Click="TimeOption_ButtonClick" Style="{StaticResource TimeOptionButton}" Content="08:00"/>
                                                <Button Tag="09:00" Click="TimeOption_ButtonClick" Style="{StaticResource TimeOptionButton}" Content="09:00"/>
                                                <Button Tag="10:00" Click="TimeOption_ButtonClick" Style="{StaticResource TimeOptionButton}" Content="10:00"/>
                                                <Button Tag="11:00" Click="TimeOption_ButtonClick" Style="{StaticResource TimeOptionButton}" Content="11:00"/>
                                                <Button Tag="12:00" Click="TimeOption_ButtonClick" Style="{StaticResource TimeOptionButton}" Content="12:00"/>
                                                <Button Tag="14:00" Click="TimeOption_ButtonClick" Style="{StaticResource TimeOptionButton}" Content="14:00"/>
                                                <Button Tag="15:00" Click="TimeOption_ButtonClick" Style="{StaticResource TimeOptionButton}" Content="15:00"/>
                                                <Button Tag="16:00" Click="TimeOption_ButtonClick" Style="{StaticResource TimeOptionButton}" Content="16:00"/>
                                                <Button Tag="17:00" Click="TimeOption_ButtonClick" Style="{StaticResource TimeOptionButton}" Content="17:00"/>
                                                <Button Tag="18:00" Click="TimeOption_ButtonClick" Style="{StaticResource TimeOptionButton}" Content="18:00"/>
                                                <Button Tag="19:00" Click="TimeOption_ButtonClick" Style="{StaticResource TimeOptionButton}" Content="19:00"/>
                                                <Button Tag="20:00" Click="TimeOption_ButtonClick" Style="{StaticResource TimeOptionButton}" Content="20:00"/>
                                                <Button Tag="21:00" Click="TimeOption_ButtonClick" Style="{StaticResource TimeOptionButton}" Content="21:00"/>
                                                <Button Tag="22:00" Click="TimeOption_ButtonClick" Style="{StaticResource TimeOptionButton}" Content="22:00"/>
                                            </StackPanel>
                                        </ScrollViewer>
                                    </Border>
                                </Popup>
                                <ComboBox x:Name="EditTimeCombo" Visibility="Collapsed"/>
                            </Grid>
                            <!-- éšè—çš„æ—¶é—´è¾“å…¥æ¡†ï¼Œä¿æŒä»£ç å…¼å®¹ -->
                            <TextBox x:Name="EditTimeBox" Visibility="Collapsed"/>
                        </Grid>
                        
                        <!-- åˆ†ç»„ -->
                        <TextBlock Text="åˆ†ç»„" Foreground="#AAAAAA" FontSize="12" FontWeight="Medium" Margin="0,0,0,8"/>
                        <Border Background="#FF252530" CornerRadius="10" Margin="0,0,0,20" BorderBrush="#40FFFFFF" BorderThickness="1">
                            <ComboBox x:Name="EditGroupCombo" FontSize="14"
                                      Background="Transparent" Foreground="White" BorderThickness="0" VerticalAlignment="Center">
                                <ComboBox.Template>
                                    <ControlTemplate TargetType="ComboBox">
                                        <Grid>
                                            <ToggleButton x:Name="ToggleButton" Focusable="False" Background="Transparent" ClickMode="Press"
                                                          IsChecked="{Binding Path=IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}">
                                                <ToggleButton.Template>
                                                    <ControlTemplate TargetType="ToggleButton">
                                                        <Border Background="Transparent" Padding="16,14">
                                                            <Grid>
                                                                <ContentPresenter HorizontalAlignment="Left" VerticalAlignment="Center"/>
                                                                <Path Fill="#888888" Data="M 0 0 L 5 5 L 10 0 Z" 
                                                                      HorizontalAlignment="Right" VerticalAlignment="Center"/>
                                                            </Grid>
                                                        </Border>
                                                    </ControlTemplate>
                                                </ToggleButton.Template>
                                            </ToggleButton>
                                            <ContentPresenter x:Name="ContentSite" IsHitTestVisible="False" Margin="16,14"
                                                              Content="{TemplateBinding SelectionBoxItem}"
                                                              ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                                              VerticalAlignment="Center" HorizontalAlignment="Left"/>
                                            <Popup x:Name="Popup" Placement="Bottom" IsOpen="{TemplateBinding IsDropDownOpen}"
                                                   AllowsTransparency="True" Focusable="False" PopupAnimation="Slide">
                                                <Border Background="#FF1E1E28" BorderBrush="#50FFFFFF" BorderThickness="1" 
                                                        CornerRadius="8" Margin="0,4,0,0" MinWidth="{TemplateBinding ActualWidth}" MaxHeight="250">
                                                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                                                        <StackPanel IsItemsHost="True"/>
                                                    </ScrollViewer>
                                                </Border>
                                            </Popup>
                                        </Grid>
                                    </ControlTemplate>
                                </ComboBox.Template>
                                <ComboBox.ItemContainerStyle>
                                    <Style TargetType="ComboBoxItem">
                                        <Setter Property="Background" Value="Transparent"/>
                                        <Setter Property="Foreground" Value="White"/>
                                        <Setter Property="Padding" Value="16,12"/>
                                        <Setter Property="Cursor" Value="Hand"/>
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="ComboBoxItem">
                                                    <Border x:Name="Bd" Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}">
                                                        <ContentPresenter/>
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter TargetName="Bd" Property="Background" Value="#30FFFFFF"/>
                                                        </Trigger>
                                                        <Trigger Property="IsSelected" Value="True">
                                                            <Setter TargetName="Bd" Property="Background" Value="#408B5CF6"/>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </ComboBox.ItemContainerStyle>
                                <ComboBoxItem Content="ðŸ“‚ æœªåˆ†ç»„" Tag=""/>
                            </ComboBox>
                        </Border>
                        
                        <!-- å¤‡æ³¨ -->
                        <TextBlock Text="å¤‡æ³¨" Foreground="#AAAAAA" FontSize="12" FontWeight="Medium" Margin="0,0,0,8"/>
                        <Border Background="#FF252530" CornerRadius="10" Padding="16,14" Margin="0,0,0,28" BorderBrush="#40FFFFFF" BorderThickness="1">
                            <Grid>
                                <TextBox x:Name="EditNoteBox" Background="Transparent" BorderThickness="0"
                                         Foreground="White" FontSize="14" CaretBrush="#8B5CF6" AcceptsReturn="True"
                                         Height="70" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto"/>
                                <TextBlock Text="æ·»åŠ å¤‡æ³¨ä¿¡æ¯..." Foreground="#555555" FontSize="14" IsHitTestVisible="False" VerticalAlignment="Top"
                                           Visibility="{Binding Text.Length, ElementName=EditNoteBox, Converter={StaticResource LengthToVisibilityConverter}}"/>
                            </Grid>
                        </Border>
                        
                        <!-- æŒ‰é’® -->
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Button Grid.Column="0" Content="å–æ¶ˆ" Background="#30FFFFFF" Foreground="White"
                                    Padding="0,16" Margin="0,0,10,0" BorderThickness="0" Cursor="Hand" Click="CloseEditPopup_Click" FontSize="14" FontWeight="SemiBold">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border x:Name="Bd" Background="{TemplateBinding Background}" CornerRadius="12" Padding="{TemplateBinding Padding}">
                                            <ContentPresenter HorizontalAlignment="Center"/>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="Bd" Property="Background" Value="#40FFFFFF"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                            <Button Grid.Column="1" Content="âœ“ ä¿å­˜" Foreground="White" FontSize="14" FontWeight="SemiBold"
                                    Padding="0,16" Margin="10,0,0,0" BorderThickness="0" Cursor="Hand" Click="SaveEdit_Click">
                                <Button.Background>
                                    <LinearGradientBrush EndPoint="1,0">
                                        <GradientStop Color="#6366F1" Offset="0"/>
                                        <GradientStop Color="#8B5CF6" Offset="1"/>
                                    </LinearGradientBrush>
                                </Button.Background>
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border x:Name="Bd" Background="{TemplateBinding Background}" CornerRadius="12" Padding="{TemplateBinding Padding}">
                                            <ContentPresenter HorizontalAlignment="Center"/>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="Bd" Property="Opacity" Value="0.85"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                        </Grid>
                    </StackPanel>
                </Border>
            </Border>
            
            <!-- ========== æ·»åŠ åˆ†ç»„å¼¹çª— ========== -->
            <Border x:Name="AddGroupPopup" Grid.ColumnSpan="2" Visibility="Collapsed" Background="#E0080810">
                <Border CornerRadius="14" Width="320" VerticalAlignment="Center" HorizontalAlignment="Center"
                        Padding="24" BorderBrush="#25FFFFFF" BorderThickness="1">
                    <Border.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                            <GradientStop Color="#F8181822" Offset="0"/>
                            <GradientStop Color="#F8101018" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <StackPanel>
                        <Grid Margin="0,0,0,18">
                            <TextBlock Text="æ·»åŠ åˆ†ç»„" Foreground="White" FontSize="18" FontWeight="SemiBold"/>
                            <Button Content="âœ•" HorizontalAlignment="Right" Style="{StaticResource IconButton}"
                                    FontSize="14" Click="CloseGroupPopup_Click"/>
                        </Grid>
                        
                        <!-- åˆ†ç»„åç§° -->
                        <TextBlock Text="åˆ†ç»„åç§°" Foreground="#70FFFFFF" FontSize="12" Margin="0,0,0,8"/>
                        <Border Background="#12FFFFFF" CornerRadius="10" Padding="14,12" Margin="0,0,0,16"
                                BorderBrush="#15FFFFFF" BorderThickness="1">
                            <TextBox x:Name="GroupNameInput" Background="Transparent" BorderThickness="0"
                                     Foreground="White" FontSize="14" CaretBrush="White" MaxLength="20"/>
                        </Border>
                        
                        <!-- å›¾æ ‡é€‰æ‹© -->
                        <TextBlock Text="é€‰æ‹©å›¾æ ‡" Foreground="#70FFFFFF" FontSize="12" Margin="0,0,0,8"/>
                        <WrapPanel x:Name="IconSelector" Margin="0,0,0,16">
                            <Border Tag="ðŸ“" MouseLeftButtonDown="SelectIcon_Click" Cursor="Hand" CornerRadius="8"
                                    Margin="0,0,8,8" Padding="10" Background="#15FFFFFF" BorderBrush="#25FFFFFF" BorderThickness="1">
                                <TextBlock Text="ðŸ“" FontSize="18"/>
                            </Border>
                            <Border Tag="ðŸ’¼" MouseLeftButtonDown="SelectIcon_Click" Cursor="Hand" CornerRadius="8"
                                    Margin="0,0,8,8" Padding="10" Background="#15FFFFFF">
                                <TextBlock Text="ðŸ’¼" FontSize="18"/>
                            </Border>
                            <Border Tag="ðŸ " MouseLeftButtonDown="SelectIcon_Click" Cursor="Hand" CornerRadius="8"
                                    Margin="0,0,8,8" Padding="10" Background="#15FFFFFF">
                                <TextBlock Text="ðŸ " FontSize="18"/>
                            </Border>
                            <Border Tag="ðŸ“š" MouseLeftButtonDown="SelectIcon_Click" Cursor="Hand" CornerRadius="8"
                                    Margin="0,0,8,8" Padding="10" Background="#15FFFFFF">
                                <TextBlock Text="ðŸ“š" FontSize="18"/>
                            </Border>
                            <Border Tag="ðŸŽ®" MouseLeftButtonDown="SelectIcon_Click" Cursor="Hand" CornerRadius="8"
                                    Margin="0,0,8,8" Padding="10" Background="#15FFFFFF">
                                <TextBlock Text="ðŸŽ®" FontSize="18"/>
                            </Border>
                            <Border Tag="ðŸ’ª" MouseLeftButtonDown="SelectIcon_Click" Cursor="Hand" CornerRadius="8"
                                    Margin="0,0,8,8" Padding="10" Background="#15FFFFFF">
                                <TextBlock Text="ðŸ’ª" FontSize="18"/>
                            </Border>
                            <Border Tag="â¤ï¸" MouseLeftButtonDown="SelectIcon_Click" Cursor="Hand" CornerRadius="8"
                                    Margin="0,0,8,8" Padding="10" Background="#15FFFFFF">
                                <TextBlock Text="â¤ï¸" FontSize="18"/>
                            </Border>
                            <Border Tag="â­" MouseLeftButtonDown="SelectIcon_Click" Cursor="Hand" CornerRadius="8"
                                    Margin="0,0,8,8" Padding="10" Background="#15FFFFFF">
                                <TextBlock Text="â­" FontSize="18"/>
                            </Border>
                        </WrapPanel>
                        
                        <!-- é¢œè‰²é€‰æ‹© -->
                        <TextBlock Text="é€‰æ‹©é¢œè‰²" Foreground="#70FFFFFF" FontSize="12" Margin="0,0,0,8"/>
                        <WrapPanel x:Name="ColorSelector" Margin="0,0,0,20">
                            <Border Tag="#6366F1" MouseLeftButtonDown="SelectColor_Click" Cursor="Hand" CornerRadius="14"
                                    Width="28" Height="28" Margin="0,0,8,8" Background="#6366F1" BorderBrush="#40FFFFFF" BorderThickness="2"/>
                            <Border Tag="#8B5CF6" MouseLeftButtonDown="SelectColor_Click" Cursor="Hand" CornerRadius="14"
                                    Width="28" Height="28" Margin="0,0,8,8" Background="#8B5CF6"/>
                            <Border Tag="#EC4899" MouseLeftButtonDown="SelectColor_Click" Cursor="Hand" CornerRadius="14"
                                    Width="28" Height="28" Margin="0,0,8,8" Background="#EC4899"/>
                            <Border Tag="#EF4444" MouseLeftButtonDown="SelectColor_Click" Cursor="Hand" CornerRadius="14"
                                    Width="28" Height="28" Margin="0,0,8,8" Background="#EF4444"/>
                            <Border Tag="#F97316" MouseLeftButtonDown="SelectColor_Click" Cursor="Hand" CornerRadius="14"
                                    Width="28" Height="28" Margin="0,0,8,8" Background="#F97316"/>
                            <Border Tag="#22C55E" MouseLeftButtonDown="SelectColor_Click" Cursor="Hand" CornerRadius="14"
                                    Width="28" Height="28" Margin="0,0,8,8" Background="#22C55E"/>
                            <Border Tag="#14B8A6" MouseLeftButtonDown="SelectColor_Click" Cursor="Hand" CornerRadius="14"
                                    Width="28" Height="28" Margin="0,0,8,8" Background="#14B8A6"/>
                            <Border Tag="#3B82F6" MouseLeftButtonDown="SelectColor_Click" Cursor="Hand" CornerRadius="14"
                                    Width="28" Height="28" Margin="0,0,8,8" Background="#3B82F6"/>
                        </WrapPanel>
                        
                        <!-- ç¡®è®¤æŒ‰é’® -->
                        <Button Content="æ·»åŠ åˆ†ç»„" Foreground="White" Padding="0,14" BorderThickness="0" 
                                Cursor="Hand" Click="ConfirmAddGroup_Click">
                            <Button.Background>
                                <LinearGradientBrush EndPoint="1,0">
                                    <GradientStop Color="#6366F1" Offset="0"/>
                                    <GradientStop Color="#8B5CF6" Offset="1"/>
                                </LinearGradientBrush>
                            </Button.Background>
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border Background="{TemplateBinding Background}" CornerRadius="10" Padding="{TemplateBinding Padding}">
                                        <ContentPresenter HorizontalAlignment="Center"/>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Opacity" Value="0.9"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>
                    </StackPanel>
                </Border>
            </Border>
            
            <!-- ========== æ”¯æŒä½œè€…å¼¹çª— ========== -->
            <Border x:Name="SupportAuthorPopup" Grid.ColumnSpan="2" Visibility="Collapsed" Background="#E0080810">
                <Border CornerRadius="16" Width="480" VerticalAlignment="Center" HorizontalAlignment="Center"
                        Padding="32" BorderBrush="#30FFFFFF" BorderThickness="1" Background="#FF1A1A22">
                    <StackPanel>
                        <Grid Margin="0,0,0,24">
                            <TextBlock Text="â˜• æ”¯æŒä½œè€…" Foreground="White" FontSize="20" FontWeight="SemiBold"/>
                            <Button Content="Ã—" HorizontalAlignment="Right" Style="{StaticResource IconButton}" 
                                    FontSize="22" Click="CloseSupportAuthorPopup_Click"/>
                        </Grid>

                        <TextBlock Text="æ„Ÿè°¢æ‚¨å¯¹ DeskFlow çš„å–œçˆ±ï¼" Foreground="#90FFFFFF" FontSize="14" TextWrapping="Wrap" HorizontalAlignment="Center" Margin="0,0,0,16"/>
                        <TextBlock Text="æ‚¨çš„æ”¯æŒæ˜¯æˆ‘æŒç»­æ›´æ–°çš„åŠ¨åŠ›ï¼" Foreground="#70FFFFFF" FontSize="12" TextWrapping="Wrap" HorizontalAlignment="Center" Margin="0,0,0,32"/>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- å¾®ä¿¡æ”¶æ¬¾ç  -->
                            <StackPanel Grid.Column="0" HorizontalAlignment="Center">
                                <Border Width="160" Height="160" Background="#15FFFFFF" CornerRadius="8" Margin="0,0,0,12">
                                    <Image Source="Assets/wechat_pay.png" Stretch="Uniform" Margin="8"/>
                                </Border>
                                <TextBlock Text="å¾®ä¿¡æ”¯ä»˜" Foreground="#90FFFFFF" FontSize="13" HorizontalAlignment="Center"/>
                            </StackPanel>

                            <!-- æ”¯ä»˜å®æ”¶æ¬¾ç  -->
                            <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                                <Border Width="160" Height="160" Background="#15FFFFFF" CornerRadius="8" Margin="0,0,0,12">
                                    <Image Source="Assets/alipay.png" Stretch="Uniform" Margin="8"/>
                                </Border>
                                <TextBlock Text="æ”¯ä»˜å®æ”¯ä»˜" Foreground="#90FFFFFF" FontSize="13" HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Grid>

                        <TextBlock Text="æ‰«ç æ”¯æŒï¼Œé‡‘é¢éšæ„ â¤ï¸" Foreground="#60FFFFFF" FontSize="12" 
                                   HorizontalAlignment="Center" Margin="0,24,0,0"/>

                        <Button Content="å…³é—­" Padding="24,10" Margin="0,24,0,0" Cursor="Hand"
                                Click="CloseSupportAuthorPopup_Click" Background="#6366F1" Foreground="White" BorderThickness="0" HorizontalAlignment="Center">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border Background="{TemplateBinding Background}" CornerRadius="8" Padding="{TemplateBinding Padding}">
                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Border>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>
                    </StackPanel>
                </Border>
            </Border>
            
            <!-- ========== çª—å£æŽ§åˆ¶æŒ‰é’®ï¼ˆå³ä¸Šè§’ï¼‰ ========== -->
            <StackPanel Grid.ColumnSpan="2" Orientation="Horizontal" 
                        HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,12,16,0">
                <Button Content="â”€" Style="{StaticResource IconButton}" Click="Minimize_Click" FontSize="14" Padding="12,8"/>
                <Button Content="âœ•" Style="{StaticResource IconButton}" Click="Close_Click" FontSize="14" Padding="12,8"/>
            </StackPanel>
        </Grid>
    </Border>
</Window>
